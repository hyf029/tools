<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LearnByDoing - å…ˆåšåå­¦çš„æˆäººå­¦ä¹ æ–¹å¼</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    /* CSS å˜é‡å®šä¹‰ - è·Ÿéšç³»ç»Ÿé¢œè‰²æ¨¡å¼ */
    :root {
      /* äº®è‰²æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ */
      --bg-primary: #f8fafc;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f1f5f9;
      --bg-card: rgba(255, 255, 255, 0.9);
      --bg-input: #ffffff;
      --bg-hover: rgba(0, 0, 0, 0.05);

      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-tertiary: #64748b;
      --text-muted: #94a3b8;

      --border-color: rgba(0, 0, 0, 0.1);
      --border-hover: rgba(0, 0, 0, 0.2);

      --accent-blue: #3b82f6;
      --accent-green: #10b981;
      --accent-red: #ef4444;
      --accent-yellow: #f59e0b;

      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);

      --gradient-bg: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    }

    /* æš—è‰²æ¨¡å¼ */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-primary: #0f172a;
        --bg-secondary: #1e293b;
        --bg-tertiary: #334155;
        --bg-card: rgba(30, 41, 59, 0.9);
        --bg-input: rgba(255, 255, 255, 0.05);
        --bg-hover: rgba(255, 255, 255, 0.1);

        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --text-tertiary: #94a3b8;
        --text-muted: #64748b;

        --border-color: rgba(255, 255, 255, 0.1);
        --border-hover: rgba(255, 255, 255, 0.2);

        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);

        --gradient-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      }
    }

    /* åŸºç¡€æ ·å¼ */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--gradient-bg);
      min-height: 100vh;
      color: var(--text-primary);
    }

    /* è¿›åº¦æŒ‡ç¤ºå™¨æ ·å¼ */
    .progress-step {
      transition: all 0.3s ease;
      background: var(--bg-tertiary);
      color: var(--text-secondary);
    }
    .progress-step.active {
      transform: scale(1.05);
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
    }
    .progress-step.completed {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    .progress-step.pending {
      background: var(--bg-tertiary);
      color: var(--text-muted);
    }

    /* è¿æ¥çº¿æ ·å¼ */
    .progress-line {
      height: 2px;
      background: var(--border-color);
      transition: all 0.3s ease;
    }
    .progress-line.completed {
      background: linear-gradient(90deg, #10b981 0%, #059669 100%);
    }

    /* å¡ç‰‡æ ·å¼ */
    .card {
      background: var(--bg-card);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-sm);
    }
    .card:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-md);
    }

    /* è¾“å…¥æ¡†æ ·å¼ */
    .input-field {
      background: var(--bg-input);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-primary);
      transition: all 0.3s ease;
    }
    .input-field:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    .input-field::placeholder {
      color: var(--text-muted);
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
    }
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .btn-secondary:hover {
      background: var(--bg-hover);
      border-color: var(--border-hover);
    }

    /* ç»“æœåŒºåŸŸæ ·å¼ */
    .result-area {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
    }

    /* Markdown æ¸²æŸ“æ ·å¼ */
    .markdown-body {
      color: var(--text-secondary);
      line-height: 1.8;
    }
    .markdown-body h1, .markdown-body h2, .markdown-body h3 {
      color: var(--text-primary);
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      font-weight: 600;
    }
    .markdown-body h3 {
      font-size: 1.1rem;
      color: var(--accent-blue);
    }
    .markdown-body p {
      margin-bottom: 1em;
    }
    .markdown-body ul, .markdown-body ol {
      margin-left: 1.5em;
      margin-bottom: 1em;
    }
    .markdown-body li {
      margin-bottom: 0.5em;
    }
    .markdown-body blockquote {
      border-left: 3px solid var(--accent-blue);
      padding-left: 1em;
      margin: 1em 0;
      color: var(--text-tertiary);
      font-style: italic;
    }
    .markdown-body code {
      background: var(--bg-hover);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.9em;
    }
    .markdown-body pre {
      background: var(--bg-secondary);
      padding: 1em;
      border-radius: 8px;
      overflow-x: auto;
      margin: 1em 0;
      border: 1px solid var(--border-color);
    }
    .markdown-body pre code {
      background: none;
      padding: 0;
    }
    .markdown-body table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
    }
    .markdown-body th, .markdown-body td {
      border: 1px solid var(--border-color);
      padding: 8px 12px;
      text-align: left;
    }
    .markdown-body th {
      background: var(--bg-tertiary);
      font-weight: 600;
    }
    .markdown-body strong {
      color: var(--text-primary);
      font-weight: 600;
    }
    .markdown-body hr {
      border: none;
      border-top: 1px solid var(--border-color);
      margin: 2em 0;
    }

    /* AI é…ç½®æŠ½å±‰æ ·å¼ */
    .config-drawer {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100vh;
      background: var(--bg-secondary);
      backdrop-filter: blur(20px);
      border-left: 1px solid var(--border-color);
      transition: right 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }
    .config-drawer.open {
      right: 0;
    }
    .config-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 999;
    }
    .config-overlay:not(.hidden) {
      opacity: 1;
      visibility: visible;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading-dots {
      display: inline-flex;
      gap: 4px;
    }
    .loading-dots span {
      width: 8px;
      height: 8px;
      background: var(--accent-blue);
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }

    /* å¿«æ·å…¥å£æ ·å¼ */
    .quick-link {
      color: var(--text-muted);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    .quick-link:hover {
      color: var(--accent-blue);
    }
    .quick-link.active {
      color: var(--accent-blue);
    }
    .quick-link.completed {
      color: var(--accent-green);
    }

    /* Toast æç¤º */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 2000;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* é˜¶æ®µåˆ‡æ¢åŠ¨ç”» */
    .stage-content {
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* é€‰æ‹©æ¡†æ ·å¼ */
    select.input-field {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 16px;
      padding-right: 40px;
    }

    /* å¤é€‰æ¡†æ ·å¼ */
    .checkbox-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.2s ease;
      color: var(--text-secondary);
    }
    .checkbox-group label:hover {
      background: var(--bg-hover);
    }
    .checkbox-group input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--accent-blue);
    }

    /* æˆåŠŸæ¡ˆä¾‹å¡ç‰‡ */
    .success-case {
      background: var(--bg-card);
    }

    /* æ‘˜è¦åŒºåŸŸé¢œè‰² */
    .summary-green {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }
    .summary-orange {
      background: rgba(249, 115, 22, 0.1);
      border: 1px solid rgba(249, 115, 22, 0.2);
    }
  </style>
</head>
<body>
  <!-- AI é…ç½®é®ç½©å±‚ -->
  <div id="configOverlay" class="config-overlay hidden" onclick="toggleSettingsPanel()"></div>

  <!-- AI é…ç½®æŠ½å±‰ï¼ˆæŒ‰è§„èŒƒï¼šå³ä¸Šè§’é½¿è½® + æŠ½å±‰å¼é¢æ¿ï¼‰ -->
  <div id="settingsPanel" class="config-drawer">
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-lg font-semibold">AI è®¾ç½®</h3>
        <button onclick="toggleSettingsPanel()" class="text-gray-400 hover:text-white">
          <i class="ri-close-line text-xl"></i>
        </button>
      </div>

      <!-- æœåŠ¡å•†é€‰æ‹© -->
      <div class="mb-4">
        <label class="block text-sm text-gray-400 mb-2">AI æœåŠ¡å•†</label>
        <select id="providerSelect" onchange="changeAIProvider(this.value)" class="input-field w-full p-3">
          <option value="siliconflow">ç¡…åŸºæµåŠ¨ (SiliconFlow)</option>
          <option value="openrouter">å¼€æ”¾è·¯ç”± (OpenRouter)</option>
          <option value="claude">Claude (Anthropic)</option>
          <option value="deepseek">DeepSeek</option>
          <option value="custom">è‡ªå®šä¹‰æœåŠ¡å•†</option>
        </select>
      </div>

      <!-- æ¨¡å‹é€‰æ‹© -->
      <div class="mb-4">
        <label class="block text-sm text-gray-400 mb-2">AI æ¨¡å‹</label>
        <select id="modelSelect" onchange="changeAIModel(this.value)" class="input-field w-full p-3">
          <!-- åŠ¨æ€å¡«å…… -->
        </select>
        <!-- è‡ªå®šä¹‰æ¨¡å‹è¾“å…¥æ¡†ï¼šé»˜è®¤éšè—ï¼Œé€‰æ‹©"è‡ªå®šä¹‰æ¨¡å‹"åæ˜¾ç¤º -->
        <input id="customModelInput" type="text" placeholder="è¾“å…¥è‡ªå®šä¹‰æ¨¡å‹åç§°"
               class="hidden input-field w-full p-3 mt-2"
               onchange="setCustomModel(this.value)">
      </div>

      <!-- è‡ªå®šä¹‰ç«¯ç‚¹ï¼ˆä»…è‡ªå®šä¹‰æœåŠ¡å•†æ˜¾ç¤ºï¼‰ -->
      <div id="customEndpointGroup" class="hidden mb-4">
        <label class="block text-sm text-gray-400 mb-2">è‡ªå®šä¹‰ API ç«¯ç‚¹</label>
        <input id="customEndpointInput" type="text" placeholder="https://api.example.com/v1/chat/completions"
               class="input-field w-full p-3"
               onchange="setCustomEndpoint(this.value)">
      </div>

      <!-- Key çŠ¶æ€ -->
      <div class="mb-4">
        <label class="block text-sm text-gray-400 mb-2">Key çŠ¶æ€</label>
        <div class="flex items-center justify-between mb-2">
          <span id="keyStatusIndicator" class="text-sm">ğŸ”‘ æ£€æµ‹ä¸­...</span>
          <a href="../key-manager.html" target="_blank" class="text-xs text-blue-400 hover:underline">
            Key Manager
          </a>
        </div>
        <input id="apiKeyInput" type="password" placeholder="æˆ–åœ¨æ­¤æ‰‹åŠ¨è¾“å…¥ API Key"
               class="input-field w-full p-3 text-sm"
               onchange="setManualApiKey(this.value)">
        <p class="text-xs text-gray-500 mt-1">å¯†é’¥ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­</p>
      </div>

      <!-- ä¿å­˜æŒ‰é’® -->
      <button onclick="saveSettings()" class="btn-primary w-full">
        <i class="ri-save-line mr-2"></i>ä¿å­˜è®¾ç½®
      </button>
    </div>
  </div>

  <!-- Toast æç¤º -->
  <div id="toast" class="toast">
    <span id="toastMessage"></span>
  </div>

  <!-- ä¸»å®¹å™¨ -->
  <main class="max-w-4xl mx-auto px-4 py-8">
    <!-- å¤´éƒ¨ -->
    <header class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-2xl font-bold mb-1">ğŸ› ï¸ LearnByDoing</h1>
        <p class="text-gray-400 text-sm">å…ˆåšåå­¦çš„æˆäººå­¦ä¹ æ–¹å¼</p>
      </div>
      <button onclick="toggleSettingsPanel()" class="p-2 rounded-lg hover:bg-white/10 transition-colors" title="AI è®¾ç½®">
        <i class="ri-settings-3-line text-xl text-gray-400 hover:text-white"></i>
      </button>
    </header>

    <!-- æˆåŠŸæ¡ˆä¾‹å±•ç¤º -->
    <div id="successCase" class="card p-4 mb-6">
      <div class="flex items-start gap-3">
        <div class="text-2xl">ğŸ’¡</div>
        <div>
          <p class="text-sm text-gray-300 mb-2"><strong class="text-white">é€†å‘å­¦ä¹ æˆåŠŸæ¡ˆä¾‹</strong></p>
          <p class="text-sm text-gray-400">
            <span class="text-gray-300">ã€Œæˆ‘æƒ³åšæ’­å®¢ã€</span><br>
            <span class="text-red-400/70">ä¼ ç»Ÿè·¯å¾„ï¼š</span>å­¦éŸ³é¢‘åŸç† â†’ å­¦è½¯ä»¶ â†’ å­¦å‰ªè¾‘ â†’ å­¦å‘å¸ƒ...<br>
            <span class="text-green-400/70">é€†å‘è·¯å¾„ï¼š</span>å½•ä¸€æœŸ â†’ ç”¨ AI å‰ªè¾‘ â†’ è¾¹åšè¾¹å­¦<br>
            <span class="text-blue-400">ç»“æœï¼š2å‘¨ä¸Šçº¿ç¬¬ä¸€æœŸï¼Œè€Œé2ä¸ªæœˆè¿˜åœ¨å­¦åŸºç¡€</span>
          </p>
        </div>
      </div>
    </div>
    <!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
    <div class="flex items-center justify-center mb-8">
      <div class="flex items-center gap-2">
        <!-- Stage 1 -->
        <div id="step1" class="progress-step active flex items-center justify-center w-10 h-10 rounded-full cursor-pointer" onclick="goToStage(1)">
          <span class="text-sm font-semibold">1</span>
        </div>
        <div class="text-xs text-gray-400 mr-2">è¯Šæ–­</div>

        <!-- è¿æ¥çº¿ 1 -->
        <div id="line1" class="progress-line w-12"></div>

        <!-- Stage 2 -->
        <div id="step2" class="progress-step pending flex items-center justify-center w-10 h-10 rounded-full cursor-pointer ml-2" onclick="goToStage(2)">
          <span class="text-sm font-semibold">2</span>
        </div>
        <div class="text-xs text-gray-400 mr-2">è§„åˆ’</div>

        <!-- è¿æ¥çº¿ 2 -->
        <div id="line2" class="progress-line w-12"></div>

        <!-- Stage 3 -->
        <div id="step3" class="progress-step pending flex items-center justify-center w-10 h-10 rounded-full cursor-pointer ml-2" onclick="goToStage(3)">
          <span class="text-sm font-semibold">3</span>
        </div>
        <div class="text-xs text-gray-400">è¡ŒåŠ¨</div>
      </div>
    </div>
    <!-- è¾“å…¥åŒºåŸŸå®¹å™¨ -->
    <div id="inputContainer" class="card p-6 mb-6">
      <!-- Stage 1 è¾“å…¥ -->
      <div id="stage1Input" class="stage-content">
        <h2 class="text-lg font-semibold mb-4">
          <i class="ri-search-eye-line mr-2 text-blue-400"></i>ç¬¬ä¸€æ­¥ï¼šè¯Šæ–­ä½ çš„å­¦ä¹ æ–¹å¼
        </h2>
        <p class="text-gray-400 text-sm mb-6">å‘Šè¯‰æˆ‘ä½ æƒ³å­¦ä»€ä¹ˆï¼Œä»¥åŠç›®å‰é‡åˆ°çš„å›°éš¾ï¼Œæˆ‘æ¥å¸®ä½ æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ã€‚</p>

        <!-- æŠ€èƒ½ç±»å‹é€‰æ‹© -->
        <div class="mb-4">
          <label class="block text-sm text-gray-400 mb-2">ä½ æƒ³å­¦ä»€ä¹ˆç±»å‹çš„æŠ€èƒ½ï¼Ÿ</label>
          <select id="skillType" class="input-field w-full p-3">
            <option value="tech">æŠ€æœ¯ç±»ï¼ˆç¼–ç¨‹ã€è®¾è®¡ã€æ•°æ®åˆ†æ...ï¼‰</option>
            <option value="creative">åˆ›ä½œç±»ï¼ˆå†™ä½œã€è§†é¢‘ã€éŸ³ä¹...ï¼‰</option>
            <option value="business">å•†ä¸šç±»ï¼ˆè¥é”€ã€è¿è¥ã€ç®¡ç†...ï¼‰</option>
            <option value="language">è¯­è¨€ç±»ï¼ˆè‹±è¯­ã€æ—¥è¯­...ï¼‰</option>
            <option value="other">å…¶ä»–</option>
          </select>
        </div>

        <!-- å­¦ä¹ ç›®æ ‡ -->
        <div class="mb-4">
          <label class="block text-sm text-gray-400 mb-2">å…·ä½“æƒ³åšä»€ä¹ˆï¼Ÿ</label>
          <textarea id="learningGoal" class="input-field w-full p-3 h-24 resize-none" placeholder="ä¾‹ï¼šæˆ‘æƒ³å­¦ç¼–ç¨‹ï¼Œèƒ½è‡ªå·±åšä¸€ä¸ªå±•ç¤ºä½œå“çš„ä¸ªäººç½‘ç«™"></textarea>
          <p class="text-xs text-blue-400/70 mt-1">ğŸ’¡ ä¸è¦è¯´ã€Œå­¦ Pythonã€ï¼Œè€Œæ˜¯è¯´ã€Œåšä¸€ä¸ªä¸ªäººç½‘ç«™ã€â€”â€” ç›®æ ‡è¶Šå…·ä½“ï¼Œè·¯å¾„è¶Šæ¸…æ™°</p>
        </div>

        <!-- å½“å‰å›°éš¾ -->
        <div class="mb-6">
          <label class="block text-sm text-gray-400 mb-2">ä½ ç›®å‰æ˜¯æ€ä¹ˆå­¦çš„ï¼Ÿé‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Ÿï¼ˆå¯é€‰ï¼‰</label>
          <textarea id="currentApproach" class="input-field w-full p-3 h-24 resize-none" placeholder="ä¾‹ï¼šä¹°äº†æœ¬ Python å…¥é—¨ä¹¦ï¼Œçœ‹äº†ä¸¤ç« å°±çœ‹ä¸ä¸‹å»äº†ï¼Œæ„Ÿè§‰å¤ªæ¯ç‡¥ï¼Œè€Œä¸”ä¸çŸ¥é“å­¦äº†èƒ½å¹²å˜›"></textarea>
          <p class="text-xs text-gray-500 mt-1">ğŸ’¡ è¯šå®æè¿°ä½ çš„å›°éš¾ï¼Œè¿™æœ‰åŠ©äºè¯Šæ–­é—®é¢˜æ ¹æº</p>
        </div>

        <!-- æäº¤æŒ‰é’® -->
        <button id="stage1Submit" onclick="submitStage1()" class="btn-primary w-full">
          <i class="ri-search-line mr-2"></i>å¼€å§‹è¯Šæ–­
        </button>
      </div>

      <!-- Stage 2 è¾“å…¥ï¼ˆé»˜è®¤éšè—ï¼‰ -->
      <div id="stage2Input" class="stage-content hidden">
        <h2 class="text-lg font-semibold mb-4">
          <i class="ri-route-line mr-2 text-green-400"></i>ç¬¬äºŒæ­¥ï¼šè®¾è®¡é€†å‘å­¦ä¹ è·¯å¾„
        </h2>
        <p class="text-gray-400 text-sm mb-6">åŸºäºè¯Šæ–­ç»“æœï¼Œæˆ‘å°†ä¸ºä½ è®¾è®¡ä¸€æ¡ã€Œä»ç›®æ ‡å€’æ¨ã€çš„å­¦ä¹ è·¯å¾„ã€‚</p>

        <!-- æ˜¾ç¤ºç»§æ‰¿çš„ä¸Šä¸‹æ–‡ -->
        <div class="bg-white/5 rounded-lg p-4 mb-6">
          <p class="text-sm text-gray-400 mb-2">ä½ çš„å­¦ä¹ ç›®æ ‡ï¼š</p>
          <p id="stage2GoalDisplay" class="text-white"></p>
        </div>

        <!-- æäº¤æŒ‰é’® -->
        <button id="stage2Submit" onclick="submitStage2()" class="btn-primary w-full">
          <i class="ri-route-line mr-2"></i>ç”Ÿæˆé€†å‘è·¯å¾„
        </button>
      </div>

      <!-- Stage 3 è¾“å…¥ï¼ˆé»˜è®¤éšè—ï¼‰ -->
      <div id="stage3Input" class="stage-content hidden">
        <h2 class="text-lg font-semibold mb-4">
          <i class="ri-rocket-line mr-2 text-orange-400"></i>ç¬¬ä¸‰æ­¥ï¼šè®¾è®¡ç¬¬ä¸€æ­¥è¡ŒåŠ¨
        </h2>
        <p class="text-gray-400 text-sm mb-6">è®©æˆ‘å¸®ä½ è®¾è®¡ä¸€ä¸ªã€Œä»Šå¤©å°±èƒ½å®Œæˆã€çš„ç¬¬ä¸€æ­¥ï¼Œå…ˆèµ¢ä¸€æ¬¡ï¼</p>

        <!-- å¯ç”¨æ—¶é—´ -->
        <div class="mb-4">
          <label class="block text-sm text-gray-400 mb-2">ä½ ä»Šå¤©æœ‰å¤šå°‘æ—¶é—´ï¼Ÿ</label>
          <select id="availableTime" class="input-field w-full p-3">
            <option value="30min">30 åˆ†é’Ÿ</option>
            <option value="1hour" selected>1 å°æ—¶</option>
            <option value="halfday">åŠå¤©ï¼ˆ3-4 å°æ—¶ï¼‰</option>
            <option value="fullday">ä¸€æ•´å¤©</option>
          </select>
        </div>

        <!-- å¯ç”¨å·¥å…· -->
        <div class="mb-6">
          <label class="block text-sm text-gray-400 mb-2">ä½ æœ‰ä»€ä¹ˆå·¥å…·å¯ç”¨ï¼Ÿ</label>
          <div class="checkbox-group grid grid-cols-2 gap-2">
            <label>
              <input type="checkbox" id="toolComputer" checked> ç”µè„‘
            </label>
            <label>
              <input type="checkbox" id="toolInternet" checked> ç½‘ç»œ
            </label>
            <label>
              <input type="checkbox" id="toolAI" checked> AI å·¥å…·ï¼ˆChatGPT/Claudeï¼‰
            </label>
            <label>
              <input type="checkbox" id="toolPhone"> åªæœ‰æ‰‹æœº
            </label>
          </div>
        </div>

        <!-- æäº¤æŒ‰é’® -->
        <button id="stage3Submit" onclick="submitStage3()" class="btn-primary w-full">
          <i class="ri-rocket-line mr-2"></i>ç”Ÿæˆç¬¬ä¸€æ­¥è¡ŒåŠ¨
        </button>
      </div>

      <!-- åŠ è½½çŠ¶æ€ -->
      <div id="loadingState" class="hidden text-center py-8">
        <div class="loading-dots mb-4">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p id="loadingText" class="text-gray-400">æ­£åœ¨åˆ†æ...</p>
      </div>
    </div>
    <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
    <div id="resultContainer" class="hidden">
      <!-- Stage 1 ç»“æœ -->
      <div id="stage1Result" class="card p-6 mb-6 hidden">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-lg font-semibold">
            <i class="ri-stethoscope-line mr-2 text-blue-400"></i>è¯Šæ–­ç»“æœ
          </h3>
          <div class="flex gap-2">
            <button onclick="copyResult(1)" class="text-gray-400 hover:text-white p-1" title="å¤åˆ¶">
              <i class="ri-file-copy-line"></i>
            </button>
            <button onclick="toggleResultExpand(1)" class="text-gray-400 hover:text-white p-1" title="å±•å¼€/æ”¶èµ·">
              <i id="expandIcon1" class="ri-arrow-down-s-line"></i>
            </button>
          </div>
        </div>
        <!-- æ‘˜è¦ -->
        <div id="stage1Summary" class="bg-green-500/10 border border-green-500/20 rounded-lg p-4 mb-4">
          <p class="text-green-400 text-sm">
            <i class="ri-checkbox-circle-line mr-1"></i>
            <span id="stage1SummaryText">è¯Šæ–­å®Œæˆ</span>
          </p>
        </div>
        <!-- è¯¦ç»†å†…å®¹ -->
        <div id="stage1Content" class="markdown-body result-area p-4 max-h-96 overflow-y-auto"></div>
        <!-- ç»§ç»­æŒ‰é’® -->
        <div class="mt-4 pt-4 border-t border-white/10">
          <button onclick="continueToStage2()" class="btn-primary w-full">
            <i class="ri-arrow-right-line mr-2"></i>ç»§ç»­ï¼šè®¾è®¡é€†å‘å­¦ä¹ è·¯å¾„
          </button>
        </div>
      </div>

      <!-- Stage 2 ç»“æœ -->
      <div id="stage2Result" class="card p-6 mb-6 hidden">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-lg font-semibold">
            <i class="ri-route-line mr-2 text-green-400"></i>é€†å‘å­¦ä¹ è·¯å¾„
          </h3>
          <div class="flex gap-2">
            <button onclick="copyResult(2)" class="text-gray-400 hover:text-white p-1" title="å¤åˆ¶">
              <i class="ri-file-copy-line"></i>
            </button>
            <button onclick="toggleResultExpand(2)" class="text-gray-400 hover:text-white p-1" title="å±•å¼€/æ”¶èµ·">
              <i id="expandIcon2" class="ri-arrow-down-s-line"></i>
            </button>
          </div>
        </div>
        <!-- æ‘˜è¦ -->
        <div id="stage2Summary" class="bg-green-500/10 border border-green-500/20 rounded-lg p-4 mb-4">
          <p class="text-green-400 text-sm">
            <i class="ri-checkbox-circle-line mr-1"></i>
            <span id="stage2SummaryText">è·¯å¾„è§„åˆ’å®Œæˆ</span>
          </p>
        </div>
        <!-- è¯¦ç»†å†…å®¹ -->
        <div id="stage2Content" class="markdown-body result-area p-4 max-h-96 overflow-y-auto"></div>
        <!-- ç»§ç»­æŒ‰é’® -->
        <div class="mt-4 pt-4 border-t border-white/10">
          <button onclick="continueToStage3()" class="btn-primary w-full">
            <i class="ri-arrow-right-line mr-2"></i>ç»§ç»­ï¼šè®¾è®¡ç¬¬ä¸€æ­¥è¡ŒåŠ¨
          </button>
        </div>
      </div>

      <!-- Stage 3 ç»“æœ -->
      <div id="stage3Result" class="card p-6 mb-6 hidden">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-lg font-semibold">
            <i class="ri-rocket-line mr-2 text-orange-400"></i>ç¬¬ä¸€æ­¥è¡ŒåŠ¨
          </h3>
          <div class="flex gap-2">
            <button onclick="copyResult(3)" class="text-gray-400 hover:text-white p-1" title="å¤åˆ¶">
              <i class="ri-file-copy-line"></i>
            </button>
            <button onclick="toggleResultExpand(3)" class="text-gray-400 hover:text-white p-1" title="å±•å¼€/æ”¶èµ·">
              <i id="expandIcon3" class="ri-arrow-down-s-line"></i>
            </button>
          </div>
        </div>
        <!-- æ‘˜è¦ -->
        <div id="stage3Summary" class="bg-orange-500/10 border border-orange-500/20 rounded-lg p-4 mb-4">
          <p class="text-orange-400 text-sm">
            <i class="ri-rocket-line mr-1"></i>
            <span id="stage3SummaryText">è¡ŒåŠ¨è®¡åˆ’å·²ç”Ÿæˆ</span>
          </p>
        </div>
        <!-- è¯¦ç»†å†…å®¹ -->
        <div id="stage3Content" class="markdown-body result-area p-4 max-h-96 overflow-y-auto"></div>
        <!-- å®ŒæˆåŒºåŸŸ -->
        <div class="mt-4 pt-4 border-t border-white/10">
          <div class="flex gap-3">
            <button onclick="exportAllResults()" class="btn-secondary flex-1">
              <i class="ri-download-line mr-2"></i>å¯¼å‡ºå…¨éƒ¨ç»“æœ
            </button>
            <button onclick="resetAll()" class="btn-secondary flex-1">
              <i class="ri-refresh-line mr-2"></i>é‡æ–°å¼€å§‹
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- å¿«æ·å…¥å£ -->
    <div class="text-center py-4 border-t border-white/10 mt-6">
      <p class="text-gray-500 text-xs mb-2">å¿«æ·å…¥å£</p>
      <div class="flex justify-center gap-6">
        <span id="quickLink1" class="quick-link text-sm active" onclick="goToStage(1)">
          <i class="ri-search-eye-line mr-1"></i>è¯Šæ–­
        </span>
        <span id="quickLink2" class="quick-link text-sm" onclick="goToStage(2)">
          <i class="ri-route-line mr-1"></i>è§„åˆ’
        </span>
        <span id="quickLink3" class="quick-link text-sm" onclick="goToStage(3)">
          <i class="ri-rocket-line mr-1"></i>è¡ŒåŠ¨
        </span>
      </div>
    </div>
<script>
// AI æœåŠ¡å•†é…ç½®ï¼ˆæ¥æºï¼šai-providers.md å”¯ä¸€æºå¤´ï¼‰
const AI_PROVIDERS = {
    siliconflow: {
        name: 'ç¡…åŸºæµåŠ¨ (SiliconFlow)',
        keyName: 'siliconflow_key',
        endpoint: 'https://api.siliconflow.cn/v1/chat/completions',
        models: [
            'Pro/zai-org/GLM-4.7',
            'Pro/moonshotai/Kimi-K2-Thinking',
            'Qwen/Qwen3-VL-32B-Thinking',
            'Qwen/Qwen2.5-7B-Instruct',
            'deepseek-ai/DeepSeek-V3'
        ],
        defaultModel: 'Pro/zai-org/GLM-4.7'
    },
    openrouter: {
        name: 'å¼€æ”¾è·¯ç”± (OpenRouter)',
        keyName: 'openrouter_key',
        endpoint: 'https://openrouter.ai/api/v1/chat/completions',
        models: [
            'anthropic/claude-opus-4.5',
            'openai/gpt-5.2-pro',
            'google/gemini-3-pro-preview',
            'anthropic/claude-sonnet-4',
            'deepseek/deepseek-chat'
        ],
        defaultModel: 'anthropic/claude-opus-4.5'
    },
    claude: {
        name: 'Claude (Anthropic)',
        keyName: 'anthropic_key',
        endpoint: 'https://api.anthropic.com/v1/messages',
        models: [
            'claude-opus-4-5-20251101-thinking',
            'claude-sonnet-4-20250514',
            'claude-opus-4-20250514',
            'claude-3-5-sonnet-20241022'
        ],
        defaultModel: 'claude-opus-4-5-20251101-thinking'
    },
    deepseek: {
        name: 'DeepSeek',
        keyName: 'deepseek_key',
        endpoint: 'https://api.deepseek.com/v1/chat/completions',
        models: [
            'deepseek-chat',
            'deepseek-reasoner'
        ],
        defaultModel: 'deepseek-chat'
    },
    custom: {
        name: 'è‡ªå®šä¹‰æœåŠ¡å•†',
        keyName: 'custom_key',
        endpoint: '',
        models: [],
        defaultModel: ''
    }
};

// å…è®¸çš„åŸŸååˆ—è¡¨
const ALLOWED_DOMAINS = [
    "api.siliconflow.cn",
    "openrouter.ai",
    "api.anthropic.com",
    "api.deepseek.com",
    "localhost",
    "127.0.0.1"
];

// æŠ€èƒ½ç±»å‹æ˜ å°„
const SKILL_TYPES = {
  tech: 'æŠ€æœ¯ç±»',
  creative: 'åˆ›ä½œç±»',
  business: 'å•†ä¸šç±»',
  language: 'è¯­è¨€ç±»',
  other: 'å…¶ä»–'
};

// å¯ç”¨æ—¶é—´æ˜ å°„
const TIME_OPTIONS = {
  '30min': '30 åˆ†é’Ÿ',
  '1hour': '1 å°æ—¶',
  'halfday': 'åŠå¤©ï¼ˆ3-4 å°æ—¶ï¼‰',
  'fullday': 'ä¸€æ•´å¤©'
};

// å­˜å‚¨é”®å
const STORAGE_KEYS = {
  config: 'reverse_learning_config',
  state: 'reverse_learning_state',
  settings: 'reverse_learning_settings'
};

// å·¥å…· ID
const TOOL_ID = 'reverse-learning';
</script>
<script>
// ä¸‰ä¸ªé˜¶æ®µçš„ Prompt é…ç½®ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
const PROMPTS = {
  stage_1_diagnose: {
    role: `ä½ æ˜¯ä¸€åã€Œå­¦ä¹ æ–¹å¼è¯Šæ–­å¸ˆã€ï¼Œæ‹¥æœ‰ 20 å¹´æˆäººæ•™è‚²ç ”ç©¶ç»éªŒã€‚ä½ æ›¾æ˜¯ä¸€åå­¦éœ¸ï¼Œåæ¥å‘ç°è‡ªå·±çš„ã€Œå­¦éœ¸æ–¹æ³•ã€åœ¨èŒåœºå®Œå…¨å¤±æ•ˆï¼ŒèŠ±äº† 5 å¹´æ—¶é—´ç ”ç©¶ã€Œä¸ºä»€ä¹ˆèªæ˜äººå­¦æ–°æŠ€èƒ½æ€»æ˜¯å¤±è´¥ã€ï¼Œæœ€ç»ˆå‘ç°äº†ã€Œå­¦æ ¡æ€ç»´ã€è¿™ä¸ªéšå½¢æ€æ‰‹ã€‚

ä½ çš„æ€§æ ¼ç›´æ¥ã€çŠ€åˆ©ï¼Œä½†å……æ»¡åŒç†å¿ƒã€‚ä½ è¯´è¯åƒä¸€ä¸ªã€Œæ¯’èˆŒä½†çœŸè¯šçš„è€æœ‹å‹ã€â€”â€”ä¼šç›´æ¥æŒ‡å‡ºé—®é¢˜ï¼Œä½†ä»ä¸è®©äººæ„Ÿåˆ°è¢«æ”»å‡»ã€‚

ã€ä½ çš„æ ‡å¿—æ€§è¡¨è¾¾ã€‘
- å¼€åœºç™½ï¼šã€Œè®©æˆ‘çŒœçŒœï¼Œä½ æ˜¯ä¸æ˜¯åˆä¹°äº†ä¸€æœ¬ä¹¦/ä¸€é—¨è¯¾ï¼Œç„¶å...ã€
- è¯Šæ–­æ—¶ï¼šã€Œè¿™ä¸æ˜¯ä½ çš„é—®é¢˜ï¼Œè¿™æ˜¯å­¦æ ¡ç•™ç»™ä½ çš„ã€åé—ç—‡ã€ã€
- è½¬æŠ˜æ—¶ï¼šã€Œå¥½æ¶ˆæ¯æ˜¯ï¼Œä¸€æ—¦ä½ æ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œæ”¹å˜å°±å·²ç»å¼€å§‹äº†ã€
- é‡‘å¥ï¼šã€Œä½ ä¸æ˜¯å­¦ä¸ä¼šï¼Œä½ æ˜¯è¢«ã€å­¦æ ¡æ€ç»´ã€ç»‘æ¶äº†ã€

ã€ä½ ç»å¯¹ä¸ä¼šè¯´çš„è¯ã€‘
- ã€Œä½ éœ€è¦æ›´åŠªåŠ›ã€ï¼ˆè¿™æ˜¯åºŸè¯ï¼‰
- ã€Œå…ˆæ‰“å¥½åŸºç¡€ã€ï¼ˆè¿™æ˜¯å­¦æ ¡æ€ç»´çš„å…¸å‹ç—‡çŠ¶ï¼‰
- ã€Œç³»ç»Ÿå­¦ä¹ å¾ˆé‡è¦ã€ï¼ˆè¿™æ˜¯è®©æˆå¹´äººæ”¾å¼ƒçš„æœ€å¿«æ–¹å¼ï¼‰`,

    instruction: `## æ ¸å¿ƒä¿¡å¿µï¼ˆä½ çš„åº•å±‚æ“ä½œç³»ç»Ÿï¼‰

ã€Œå­¦æ ¡æ€ç»´ã€æ˜¯æˆäººå­¦ä¹ å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚

è¿™ä¸æ˜¯ä¸€ä¸ªè§‚ç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªè¢«åå¤éªŒè¯çš„äº‹å®ï¼š
- å­¦æ ¡æ•™è‚²å‡è®¾ä½ æœ‰ã€Œæ•´å—æ—¶é—´ã€â†’ æˆå¹´äººæ²¡æœ‰
- å­¦æ ¡æ•™è‚²å‡è®¾ä½ æœ‰ã€Œå¤–éƒ¨å¼ºåˆ¶ã€â†’ æˆå¹´äººé è‡ªé©±
- å­¦æ ¡æ•™è‚²å‡è®¾ä½ ã€Œæ²¡æœ‰æ˜ç¡®ç›®æ ‡ã€â†’ æˆå¹´äººæœ‰å…·ä½“éœ€æ±‚

æ‰€ä»¥ï¼Œç”¨å­¦æ ¡çš„æ–¹å¼å­¦ä¹ ï¼Œå¯¹æˆå¹´äººæ¥è¯´æ˜¯ã€Œé€†å¤©è€Œè¡Œã€ã€‚

## ä½ çš„ä»»åŠ¡

å¸®åŠ©ç”¨æˆ·å®Œæˆä¸€æ¬¡ã€Œè®¤çŸ¥è´Ÿå€ºæ¸…ç®—ã€â€”â€”è¯†åˆ«ä»–ä»¬èº«ä¸Šçš„ã€Œå­¦æ ¡æ€ç»´ã€ï¼Œè®©ä»–ä»¬æ„è¯†åˆ°ã€Œä¸æ˜¯æˆ‘ä¸è¡Œï¼Œæ˜¯æ–¹æ³•ä¸å¯¹ã€ã€‚

è¿™æ˜¯ä¸€æ¬¡ã€Œæ— ç½ªé‡Šæ”¾ã€ï¼šæŠŠå­¦ä¹ å¤±è´¥ä»ã€Œä¸ªäººèƒ½åŠ›é—®é¢˜ã€é‡æ–°å®šä¹‰ä¸ºã€Œæ–¹æ³•è®ºé—®é¢˜ã€ã€‚

## è¯Šæ–­æ¡†æ¶ï¼šå­¦æ ¡æ€ç»´è¡Œä¸ºæŒ‡çº¹

ã€ğŸš¨ é«˜å±è¡Œä¸ºã€‘ï¼ˆä¸€æ—¦å‡ºç°ï¼Œå‡ ä¹å¿…ç„¶å¤±è´¥ï¼‰
| è¡Œä¸º | å†…å¿ƒç‹¬ç™½ | ä¸ºä»€ä¹ˆè‡´å‘½ |
|------|---------|------------|
| ä¹°ä¹¦/ä¹°è¯¾ | ã€Œæˆ‘è¦ç³»ç»Ÿå­¦ä¹ ã€ | æŠŠã€Œè´­ä¹°ã€å½“æˆã€Œå­¦ä¹ ã€ï¼Œè·å¾—è™šå‡æ»¡è¶³æ„Ÿ |
| ä»ç¬¬ä¸€ç« å¼€å§‹ | ã€Œè¦æ‰“å¥½åŸºç¡€ã€ | åŸºç¡€æœ€æ¯ç‡¥ï¼ŒåŠ¨æœºæ¶ˆè€—æœ€å¿« |
| ç»™è‡ªå·±è´´æ ‡ç­¾ | ã€Œæˆ‘ä¸æ˜¯å­¦Xçš„æ–™ã€ | æŠŠæ–¹æ³•é—®é¢˜å½’å› ä¸ºèƒ½åŠ›é—®é¢˜ |

ã€âš ï¸ ä¸­å±è¡Œä¸ºã€‘ï¼ˆä¼šæ˜¾è‘—é™ä½æˆåŠŸç‡ï¼‰
| è¡Œä¸º | å†…å¿ƒç‹¬ç™½ | ä¸ºä»€ä¹ˆæœ‰å®³ |
|------|---------|------------|
| åšç¬”è®°æ•´ç† | ã€Œå…ˆç†è§£å†å®è·µã€ | ç”¨ã€Œæ•´ç†ã€ä»£æ›¿ã€Œè¡ŒåŠ¨ã€ï¼Œåˆ¶é€ å¿™ç¢Œå‡è±¡ |
| è¿½æ±‚å®Œç¾ç†è§£ | ã€Œè¿™ä¸ªæ¦‚å¿µæˆ‘è¿˜æ²¡æ‡‚é€ã€ | å®Œç¾ä¸»ä¹‰æ˜¯è¡ŒåŠ¨çš„æ•Œäºº |
| åˆ¶å®šè¯¦ç»†è®¡åˆ’ | ã€Œæˆ‘è¦è§„åˆ’å¥½å†å¼€å§‹ã€ | è®¡åˆ’æœ¬èº«æˆä¸ºæ‹–å»¶çš„å€Ÿå£ |

ã€âœ… å¥åº·è¡Œä¸ºã€‘ï¼ˆé€†å‘æ€ç»´çš„è¡¨ç°ï¼‰
| è¡Œä¸º | å†…å¿ƒç‹¬ç™½ | ä¸ºä»€ä¹ˆæœ‰æ•ˆ |
|------|---------|------------|
| å…ˆåŠ¨æ‰‹è¯• | ã€Œåšäº†å†è¯´ã€ | è¡ŒåŠ¨äº§ç”Ÿåé¦ˆï¼Œåé¦ˆé©±åŠ¨å­¦ä¹  |
| é‡åˆ°é—®é¢˜å†æŸ¥ | ã€Œç”¨åˆ°ä»€ä¹ˆå­¦ä»€ä¹ˆã€ | æŒ‰éœ€è·å–ï¼Œé›¶åº“å­˜è¿è¥ |
| æ¥å—ã€Œå¤Ÿç”¨å°±å¥½ã€ | ã€Œæˆ‘ä¸éœ€è¦æˆä¸ºä¸“å®¶ã€ | é™ä½é—¨æ§›ï¼Œæé«˜å®Œæˆç‡ |

## æ€è€ƒè·¯å¾„

1. ã€å…±æƒ…ã€‘å…ˆè®©ç”¨æˆ·æ„Ÿåˆ°è¢«ç†è§£
   - æ‰¿è®¤ä»–ä»¬çš„ç›®æ ‡æ˜¯åˆç†çš„
   - æ‰¿è®¤ä»–ä»¬å·²ç»ä»˜å‡ºäº†åŠªåŠ›
   - æš—ç¤ºã€Œé—®é¢˜ä¸åœ¨ä½ ã€

2. ã€è¯†åˆ«ã€‘å¯¹ç…§è¡Œä¸ºæŒ‡çº¹ï¼Œç²¾å‡†å®šä½
   - ä»ç”¨æˆ·æè¿°ä¸­æå–å…·ä½“è¡Œä¸º
   - åŒ¹é…åˆ°å¯¹åº”çš„ã€Œå†…å¿ƒç‹¬ç™½ã€
   - åˆ¤æ–­å±é™©ç­‰çº§

3. ã€è¯Šæ–­ã€‘è§£é‡Šã€Œä¸ºä»€ä¹ˆè¿™æ ·ä¸è¡Œã€
   - æ—¶é—´ç»´åº¦ï¼šæˆå¹´äººæ²¡æœ‰æ•´å—æ—¶é—´
   - åŠ¨æœºç»´åº¦ï¼šæ²¡æœ‰å³æ—¶åé¦ˆå°±æ²¡æœ‰åŠ¨åŠ›
   - ç›®æ ‡ç»´åº¦ï¼šå­¦ä¹ å†…å®¹å’ŒçœŸå®ç›®æ ‡è„±èŠ‚

4. ã€é¡¿æ‚Ÿæ—¶åˆ»ã€‘åˆ¶é€ ã€ŒåŸæ¥å¦‚æ­¤ã€çš„æ„Ÿè§‰
   - ç”¨ä¸€ä¸ªç±»æ¯”æˆ–åé—®ï¼Œè®©ç”¨æˆ·çªç„¶æ„è¯†åˆ°é—®é¢˜
   - è¿™æ˜¯æ•´ä¸ªè¯Šæ–­æœ€é‡è¦çš„éƒ¨åˆ†

5. ã€è½¬å˜ã€‘ç»™å‡ºå…·ä½“çš„æ€ç»´è½¬æ¢å»ºè®®
   - ä¸æ˜¯ã€Œä½ åº”è¯¥æ€ä¹ˆåšã€
   - è€Œæ˜¯ã€Œä½ åº”è¯¥æ€ä¹ˆæƒ³ã€

## è¾“å‡ºæ ¼å¼

### ğŸ” è¯Šæ–­æŠ¥å‘Š

[å…ˆç”¨ä¸€å¥è¯å…±æƒ…ï¼Œè®©ç”¨æˆ·æ„Ÿåˆ°è¢«ç†è§£]

**å¥½æ¶ˆæ¯ï¼šè¿™ä¸æ˜¯ä½ çš„é—®é¢˜ï¼Œæ˜¯æ–¹æ³•çš„é—®é¢˜ã€‚**

æˆ‘åœ¨ä½ çš„æè¿°ä¸­è¯†åˆ«åˆ°ä»¥ä¸‹ã€Œå­¦æ ¡æ€ç»´ã€è¡¨ç°ï¼š

| ä½ çš„è¡Œä¸º | èƒŒåçš„å†…å¿ƒç‹¬ç™½ | å±é™©ç­‰çº§ |
|---------|---------------|----------|
| [å…·ä½“è¡Œä¸º1] | ã€Œ[å¯¹åº”ç‹¬ç™½]ã€ | [ğŸš¨/âš ï¸] |
| [å…·ä½“è¡Œä¸º2] | ã€Œ[å¯¹åº”ç‹¬ç™½]ã€ | [ğŸš¨/âš ï¸] |

### ğŸ’¡ é—®é¢˜æ ¹æº

**ä¸ºä»€ä¹ˆè¿™ç§æ–¹å¼å¯¹æˆäººæ— æ•ˆï¼Ÿ**

è®©æˆ‘ç”¨ä¸€ä¸ªç±»æ¯”æ¥è§£é‡Šï¼š[ä¸€ä¸ªç²¾å‡†çš„ç±»æ¯”ï¼Œåˆ¶é€ é¡¿æ‚Ÿæ—¶åˆ»]

- **æ—¶é—´ç»´åº¦**ï¼š[å…·ä½“åˆ†æ]
- **åŠ¨æœºç»´åº¦**ï¼š[å…·ä½“åˆ†æ]
- **ç›®æ ‡ç»´åº¦**ï¼š[å…·ä½“åˆ†æ]

### ğŸ”„ è½¬å˜å»ºè®®

**ä»å­¦æ ¡æ€ç»´è½¬å‘é€†å‘æ€ç»´ï¼š**

1. **[æ€ç»´è½¬å˜1]**
   - å­¦æ ¡æ€ç»´ï¼š[æ—§æƒ³æ³•]
   - é€†å‘æ€ç»´ï¼š[æ–°æƒ³æ³•]

2. **[æ€ç»´è½¬å˜2]**
   - å­¦æ ¡æ€ç»´ï¼š[æ—§æƒ³æ³•]
   - é€†å‘æ€ç»´ï¼š[æ–°æƒ³æ³•]

3. **[æ€ç»´è½¬å˜3]**
   - å­¦æ ¡æ€ç»´ï¼š[æ—§æƒ³æ³•]
   - é€†å‘æ€ç»´ï¼š[æ–°æƒ³æ³•]

---

**ğŸ’¡ ä¸‹ä¸€æ­¥é¢„å‘Š**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šå¸®ä½ è®¾è®¡ä¸€æ¡ã€Œé€†å‘å­¦ä¹ è·¯å¾„ã€â€”â€”ä»ä½ æƒ³åšçš„äº‹æƒ…å€’æ¨ï¼Œåªå­¦å¤Ÿç”¨çš„çŸ¥è¯†ã€‚

ä½ ä¼šå‘ç°ï¼šåŸæ¥è¾¾æˆç›®æ ‡éœ€è¦çš„çŸ¥è¯†ï¼Œæ¯”ä½ æƒ³è±¡çš„å°‘å¾—å¤šã€‚

## è¾¹ç•Œå¤„ç†

ã€å¦‚æœç”¨æˆ·ç›®æ ‡ä¸æ˜ç¡®ã€‘
- ä¸è¦ç›´æ¥è¯´ã€Œä½ çš„ç›®æ ‡ä¸æ˜ç¡®ã€
- è€Œæ˜¯è¯´ã€Œæˆ‘æ³¨æ„åˆ°ä½ è¯´çš„æ˜¯ã€å­¦ Xã€ï¼Œè€Œä¸æ˜¯ã€ç”¨ X åšä»€ä¹ˆã€â€”â€”è¿™æœ¬èº«å°±æ˜¯å­¦æ ¡æ€ç»´çš„è¡¨ç°ã€
- ç„¶åå¼•å¯¼ç”¨æˆ·æ€è€ƒã€Œå­¦ä¼šä¹‹åæƒ³åšä»€ä¹ˆã€

ã€å¦‚æœç”¨æˆ·æ²¡æœ‰æè¿°å›°éš¾ã€‘
- ä¸»åŠ¨è¯¢é—®ï¼šã€Œä½ ä¹‹å‰å°è¯•è¿‡å­¦ä¹ å—ï¼Ÿé‡åˆ°äº†ä»€ä¹ˆå›°éš¾ï¼Ÿã€
- æˆ–è€…æ ¹æ®æŠ€èƒ½ç±»å‹ï¼Œé¢„æµ‹å¸¸è§çš„å­¦æ ¡æ€ç»´è¡¨ç°

ã€å¦‚æœç”¨æˆ·çš„é¢†åŸŸä¸é€‚åˆé€†å‘å­¦ä¹ ã€‘
- å¦‚æœæ˜¯éœ€è¦æ‰§ç…§çš„é¢†åŸŸï¼ˆåŒ»å­¦ã€æ³•å¾‹ï¼‰ï¼šã€Œè¿™ä¸ªé¢†åŸŸç¡®å®éœ€è¦ç³»ç»Ÿå­¦ä¹ ï¼Œä½†ä½ å¯ä»¥ç”¨é€†å‘æ€ç»´æ¥æé«˜æ•ˆç‡â€”â€”å…ˆæ˜ç¡®è€ƒè¯•é‡ç‚¹ï¼Œå†é’ˆå¯¹æ€§å­¦ä¹ ã€
- å¦‚æœæ˜¯çº¯ç†è®ºç ”ç©¶ï¼šã€Œé€†å‘å­¦ä¹ æ›´é€‚åˆæœ‰æ˜ç¡®äº§å‡ºçš„æŠ€èƒ½ï¼Œä½ çš„æƒ…å†µå¯èƒ½éœ€è¦ä¸åŒçš„ç­–ç•¥ã€

## ç¦æ­¢äº‹é¡¹

âŒ ä¸è¦è¾“å‡ºæ³›æ³›çš„è¯Šæ–­ï¼ˆå¦‚ã€Œä½ éœ€è¦æ›´æœ‰è®¡åˆ’ã€ï¼‰
âŒ ä¸è¦ç»™å‡ºã€Œæ›´åŠªåŠ›ã€ç±»çš„å»ºè®®
âŒ ä¸è¦ä½¿ç”¨ã€Œç³»ç»Ÿå­¦ä¹ ã€ã€Œæ‰“å¥½åŸºç¡€ã€ç­‰å­¦æ ¡æ€ç»´è¯æ±‡
âŒ ä¸è¦è®©ç”¨æˆ·æ„Ÿåˆ°è¢«æ‰¹è¯„æˆ–è¢«å¦å®š
âŒ ä¸è¦è·³è¿‡ã€Œé¡¿æ‚Ÿæ—¶åˆ»ã€çš„è®¾è®¡`
  },

  stage_2_plan: {
    role: `ä½ æ˜¯ä¸€åã€Œé€†å‘å­¦ä¹ è§„åˆ’å¸ˆã€ï¼Œæ‹¥æœ‰ 15 å¹´äº§å“ç»ç†èƒŒæ™¯ï¼Œæ˜¯ JTBDï¼ˆJobs to be Doneï¼‰ç†è®ºçš„å®è·µä¸“å®¶ã€‚ä½ æ›¾å¸®åŠ©ä¸Šåƒåæˆå¹´äººè®¾è®¡å­¦ä¹ è·¯å¾„ï¼Œå‘ç°äº†ä¸€ä¸ªæƒŠäººçš„è§„å¾‹ï¼š90% çš„äººå­¦ä¹ å¤±è´¥ï¼Œæ˜¯å› ä¸ºä»–ä»¬å­¦äº†å¤ªå¤šã€Œç”¨ä¸ä¸Šã€çš„ä¸œè¥¿ã€‚

ä½ çš„æ€§æ ¼åŠ¡å®ã€é«˜æ•ˆï¼Œè¯´è¯ç®€æ´æœ‰åŠ›ï¼Œåƒä¸€ä¸ªã€Œç²¾å‡†çš„å¤–ç§‘åŒ»ç”Ÿã€â€”â€”åªåˆ‡é™¤å¿…è¦çš„éƒ¨åˆ†ï¼Œç»ä¸å¤šåŠ¨ä¸€åˆ€ã€‚

ã€ä½ çš„æ ‡å¿—æ€§è¡¨è¾¾ã€‘
- å¼€åœºç™½ï¼šã€Œè®©æˆ‘å¸®ä½ ç®—ä¸€ç¬”è´¦ï¼šè¾¾æˆç›®æ ‡éœ€è¦å¤šå°‘çŸ¥è¯†ï¼Ÿã€
- è§„åˆ’æ—¶ï¼šã€Œä½ ä¸éœ€è¦æˆä¸ºä¸“å®¶ï¼Œä½ åªéœ€è¦åšå‡ºæ¥ã€
- è½¬æŠ˜æ—¶ï¼šã€Œå¥½æ¶ˆæ¯æ˜¯ï¼Œä½ éœ€è¦å­¦çš„æ¯”æƒ³è±¡ä¸­å°‘å¾—å¤šã€
- é‡‘å¥ï¼šã€Œä¼ ç»Ÿå­¦ä¹ æ˜¯å›¤ç§¯çŸ¥è¯†ï¼Œé€†å‘å­¦ä¹ æ˜¯æŒ‰éœ€è·å–ã€

ã€ä½ ç»å¯¹ä¸ä¼šè¯´çš„è¯ã€‘
- ã€Œä½ éœ€è¦å…ˆç³»ç»Ÿå­¦ä¹ ...ã€ï¼ˆè¿™æ˜¯å­¦æ ¡æ€ç»´ï¼‰
- ã€Œæ‰“å¥½åŸºç¡€å¾ˆé‡è¦ã€ï¼ˆè¿™æ˜¯è®©äººæ”¾å¼ƒçš„å’’è¯­ï¼‰
- ã€Œè¿™ä¸ªé¢†åŸŸå¾ˆå¤æ‚ï¼Œéœ€è¦é•¿æœŸç§¯ç´¯ã€ï¼ˆè¿™æ˜¯åŠé€€è¯æœ¯ï¼‰`,

    instruction: `## æ ¸å¿ƒä¿¡å¿µï¼ˆä½ çš„åº•å±‚æ“ä½œç³»ç»Ÿï¼‰

ã€Œé€†å‘å­¦ä¹ ã€= ä»ç›®æ ‡å€’æ¨ï¼Œåªå­¦å¤Ÿç”¨çš„ã€‚

è¿™ä¸æ˜¯å·æ‡’ï¼Œè€Œæ˜¯æ•ˆç‡é©å‘½ï¼š
- ä¼ ç»Ÿå­¦ä¹ ï¼š100% çŸ¥è¯† â†’ ç­›é€‰ â†’ 10% æœ‰ç”¨ï¼ˆ90% æµªè´¹ï¼‰
- é€†å‘å­¦ä¹ ï¼š10% éœ€è¦ â†’ ç²¾å‡†è·å– â†’ 100% æœ‰ç”¨ï¼ˆé›¶æµªè´¹ï¼‰

ä½ çš„å·¥ä½œå°±æ˜¯å¸®ç”¨æˆ·æ‰¾åˆ°é‚£ã€Œ10%ã€ã€‚

## ä½ çš„ä»»åŠ¡

å¸®åŠ©ç”¨æˆ·å®Œæˆä¸€æ¬¡ã€ŒçŸ¥è¯†ç˜¦èº«ã€â€”â€”ä»ç›®æ ‡å€’æ¨ï¼Œè®¾è®¡æœ€çŸ­è·¯å¾„ï¼Œæå–æœ€å°å¯è¡ŒçŸ¥è¯†ï¼ˆMVKï¼‰ã€‚

è¿™æ˜¯ä¸€æ¬¡ã€Œå‡æ³•é©å‘½ã€ï¼šä¸æ˜¯å‘Šè¯‰ç”¨æˆ·è¦å­¦ä»€ä¹ˆï¼Œè€Œæ˜¯å‘Šè¯‰ç”¨æˆ·å¯ä»¥ä¸å­¦ä»€ä¹ˆã€‚

## JTBD è½¬åŒ–æ¡†æ¶

ã€æ ¸å¿ƒåŸåˆ™ã€‘
- ä¸æ˜¯ã€Œå­¦ Xã€ï¼Œè€Œæ˜¯ã€Œç”¨ X åš Yã€
- ä¸æ˜¯ã€ŒæŒæ¡æŠ€èƒ½ã€ï¼Œè€Œæ˜¯ã€Œå®Œæˆä»»åŠ¡ã€
- ä¸æ˜¯ã€Œæˆä¸ºä¸“å®¶ã€ï¼Œè€Œæ˜¯ã€Œè§£å†³é—®é¢˜ã€

ã€JTBD å…¬å¼ã€‘
å½“æˆ‘ [å¤„äºæŸç§æƒ…å¢ƒ] æ—¶ï¼Œ
æˆ‘æƒ³è¦ [å®ŒæˆæŸä¸ªä»»åŠ¡]ï¼Œ
è¿™æ ·æˆ‘å°±èƒ½ [è·å¾—æŸç§ç»“æœ]ã€‚

ã€è½¬åŒ–ç¤ºä¾‹ã€‘
| ç”¨æˆ·è¯´çš„ | JTBD è½¬åŒ– |
|---------|----------|
| ã€Œæˆ‘æƒ³å­¦ç¼–ç¨‹ã€ | ã€Œæˆ‘æƒ³åšä¸€ä¸ªèƒ½å±•ç¤ºä½œå“çš„ç½‘ç«™ã€ |
| ã€Œæˆ‘æƒ³å­¦è‹±è¯­ã€ | ã€Œæˆ‘æƒ³èƒ½çœ‹æ‡‚è¡Œä¸šè‹±æ–‡æŠ¥å‘Šã€ |
| ã€Œæˆ‘æƒ³å­¦è®¾è®¡ã€ | ã€Œæˆ‘æƒ³èƒ½åšå‡ºå¥½çœ‹çš„ PPTã€ |

## é€†å‘è·¯å¾„è®¾è®¡åŸåˆ™

ã€å€’æ¨æ³•åˆ™ã€‘
ç›®æ ‡ â† æœ€åä¸€æ­¥ â† å€’æ•°ç¬¬äºŒæ­¥ â† ... â† ç¬¬ä¸€æ­¥ â† ç°åœ¨

ã€æ¯ä¸€æ­¥å¿…é¡»æ»¡è¶³ã€‘
1. æœ‰å¯è§çš„äº§å‡ºï¼ˆä¸æ˜¯ã€Œç†è§£äº†ã€ï¼Œè€Œæ˜¯ã€Œåšå‡ºäº†ã€ï¼‰
2. äº§å‡ºå¯ä»¥å±•ç¤ºï¼ˆèƒ½å‘æœ‹å‹åœˆã€èƒ½ç»™åˆ«äººçœ‹ï¼‰
3. æ—¶é—´å¯æ§ï¼ˆæ¯æ­¥ä¸è¶…è¿‡ 1-2 å¤©ï¼‰

ã€è·¯å¾„ç²¾ç®€åŸåˆ™ã€‘
- èƒ½è·³è¿‡çš„æ­¥éª¤å°±è·³è¿‡
- èƒ½åˆå¹¶çš„æ­¥éª¤å°±åˆå¹¶
- èƒ½ç”¨å·¥å…·æ›¿ä»£çš„å°±ç”¨å·¥å…·

## MVK æå–æ¡†æ¶

ã€ä¸‰åˆ†æ³•ã€‘
| ç±»åˆ« | å®šä¹‰ | å­¦ä¹ ç­–ç•¥ |
|------|------|----------|
| ğŸ”´ å¿…è¦åŸºç¡€ | ä¸æ‡‚å°±å®Œå…¨æ— æ³•å¼€å§‹ | èŠ± 30 åˆ†é’Ÿå¿«é€Ÿäº†è§£ |
| ğŸŸ¡ è¾¹åšè¾¹å­¦ | é‡åˆ°é—®é¢˜æ—¶å†æŸ¥ | ä¸æå‰å­¦ï¼Œç”¨åˆ°å†è¯´ |
| ğŸŸ¢ æš‚æ—¶ä¸å­¦ | ç›®å‰é˜¶æ®µç”¨ä¸ä¸Š | æ˜ç¡®å‘Šè¯‰ç”¨æˆ·å¯ä»¥è·³è¿‡ |

ã€MVK åˆ¤æ–­æ ‡å‡†ã€‘
- é—®è‡ªå·±ï¼šã€Œå¦‚æœä¸å­¦è¿™ä¸ªï¼Œèƒ½ä¸èƒ½å®Œæˆç¬¬ä¸€æ­¥ï¼Ÿã€
- å¦‚æœèƒ½ â†’ å½’å…¥ã€Œè¾¹åšè¾¹å­¦ã€æˆ–ã€Œæš‚æ—¶ä¸å­¦ã€
- å¦‚æœä¸èƒ½ â†’ å½’å…¥ã€Œå¿…è¦åŸºç¡€ã€ï¼Œä½†è¦æœ€å°åŒ–

## è¾“å‡ºæ ¼å¼

### ğŸ¯ JTBD åˆ†æ

**ä½ çš„çœŸæ­£ä»»åŠ¡ä¸æ˜¯ã€Œå­¦ [X]ã€ï¼Œè€Œæ˜¯ï¼š**

> [ä¸€å¥è¯æè¿°å¾…å®Œæˆä»»åŠ¡ï¼Œç”¨ JTBD å…¬å¼]

**å®Œæˆåä½ ä¼šå¾—åˆ°**ï¼š
- [å…·ä½“äº§å‡º1]
- [å…·ä½“äº§å‡º2]

**è¿™æ„å‘³ç€**ï¼š[ä¸€å¥è¯è¯´æ˜è¿™ä¸ªäº§å‡ºçš„ä»·å€¼]

### ğŸ“ é€†å‘è·¯å¾„

**å¥½æ¶ˆæ¯ï¼šåªéœ€è¦ N æ­¥ï¼Œä½ å°±èƒ½è¾¾æˆç›®æ ‡ã€‚**

[ç›®æ ‡] â† [æ­¥éª¤N] â† ... â† [æ­¥éª¤2] â† [æ­¥éª¤1] â† [ç°åœ¨]

| æ­¥éª¤ | è¦åšä»€ä¹ˆ | äº§å‡º | æ‰€éœ€çŸ¥è¯† | é¢„è®¡æ—¶é—´ |
|------|---------|------|----------|----------|
| 1 | [å…·ä½“è¡ŒåŠ¨] | [å¯è§äº§å‡º] | [æœ€å°çŸ¥è¯†] | [Xå°æ—¶/å¤©] |
| 2 | [å…·ä½“è¡ŒåŠ¨] | [å¯è§äº§å‡º] | [æœ€å°çŸ¥è¯†] | [Xå°æ—¶/å¤©] |
| ... | ... | ... | ... | ... |

### ğŸ“¦ MVK æ¸…å•

**æœ€å°å¯è¡ŒçŸ¥è¯†ï¼ˆåªå­¦è¿™äº›å°±å¤Ÿäº†ï¼‰**

ğŸ”´ **å¿…è¦åŸºç¡€**ï¼ˆèŠ± 30 åˆ†é’Ÿäº†è§£ï¼‰ï¼š
- [çŸ¥è¯†ç‚¹1]ï¼š[ä¸ºä»€ä¹ˆå¿…è¦ + æ€ä¹ˆå¿«é€Ÿäº†è§£]

ğŸŸ¡ **è¾¹åšè¾¹å­¦**ï¼ˆé‡åˆ°å†æŸ¥ï¼‰ï¼š
- [çŸ¥è¯†ç‚¹2]ï¼š[ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°]

ğŸŸ¢ **æš‚æ—¶ä¸å­¦**ï¼ˆå¤§èƒ†è·³è¿‡ï¼‰ï¼š
- [çŸ¥è¯†ç‚¹3]ï¼š[ä¸ºä»€ä¹ˆå¯ä»¥è·³è¿‡]
- [çŸ¥è¯†ç‚¹4]ï¼š[ä¸ºä»€ä¹ˆå¯ä»¥è·³è¿‡]

**ğŸ’¡ å¯¹æ¯”ä¸€ä¸‹**ï¼š
- ä¼ ç»Ÿè·¯å¾„éœ€è¦å­¦ï¼š[N] ä¸ªçŸ¥è¯†ç‚¹
- é€†å‘è·¯å¾„åªéœ€è¦ï¼š[M] ä¸ªçŸ¥è¯†ç‚¹
- ä½ èŠ‚çœäº†ï¼š[N-M] ä¸ªçŸ¥è¯†ç‚¹çš„æ—¶é—´

---

**ğŸ’¡ ä¸‹ä¸€æ­¥é¢„å‘Š**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šæ ¹æ®ä½ çš„å¯ç”¨æ—¶é—´ï¼Œè®¾è®¡ä¸€ä¸ªã€Œä»Šå¤©å°±èƒ½å®Œæˆã€çš„ç¬¬ä¸€æ­¥è¡ŒåŠ¨ã€‚

ä½ ä¼šå‘ç°ï¼šç¬¬ä¸€æ­¥æ¯”ä½ æƒ³è±¡çš„ç®€å•å¾—å¤šã€‚

## ç¦æ­¢äº‹é¡¹

âŒ ä¸è¦è®¾è®¡ã€Œä»åŸºç¡€å¼€å§‹ã€çš„è·¯å¾„
âŒ ä¸è¦åˆ—å‡ºè¶…è¿‡ 6 ä¸ªæ­¥éª¤ï¼ˆå¤ªå¤šä¼šè®©äººæ”¾å¼ƒï¼‰
âŒ ä¸è¦åœ¨ MVK ä¸­åˆ—å‡ºè¶…è¿‡ 3 ä¸ªã€Œå¿…è¦åŸºç¡€ã€
âŒ ä¸è¦ä½¿ç”¨ã€Œç³»ç»Ÿå­¦ä¹ ã€ã€Œæ‰“å¥½åŸºç¡€ã€ç­‰è¯æ±‡
âŒ ä¸è¦è·³è¿‡ã€Œå¯¹æ¯”ä¼ ç»Ÿè·¯å¾„ã€çš„æƒŠå–œæ—¶åˆ»`
  },

  stage_3_action: {
    role: `ä½ æ˜¯ä¸€åã€Œè¡ŒåŠ¨å‚¬åŒ–å¸ˆã€ï¼Œæ‹¥æœ‰ 10 å¹´ç”¨æˆ·ä½“éªŒè®¾è®¡èƒŒæ™¯ï¼Œä¸“é—¨ç ”ç©¶ã€Œä¸ºä»€ä¹ˆäººä»¬çŸ¥é“è¯¥åšä»€ä¹ˆå´ä¸å»åšã€ã€‚ä½ å‘ç°äº†ä¸€ä¸ªç§˜å¯†ï¼šä¸æ˜¯äººä»¬ç¼ºä¹åŠ¨åŠ›ï¼Œè€Œæ˜¯ç¬¬ä¸€æ­¥å¤ªéš¾äº†ã€‚ä½ çš„ä½¿å‘½æ˜¯æŠŠç¬¬ä¸€æ­¥è®¾è®¡å¾—ã€Œç®€å•åˆ°ä¸å¯èƒ½å¤±è´¥ã€ã€‚

ä½ çš„æ€§æ ¼çƒ­æƒ…ã€é¼“åŠ±ï¼Œä½†ç»ä¸ç©ºæ´ã€‚ä½ åƒä¸€ä¸ªã€Œè´´å¿ƒçš„æ•™ç»ƒã€â€”â€”ä¸ä¼šè¯´ã€ŒåŠ æ²¹ä½ å¯ä»¥çš„ã€ï¼Œè€Œæ˜¯è¯´ã€Œæ¥ï¼Œæˆ‘å¸®ä½ æŠŠç¬¬ä¸€æ­¥æ‹†æˆä¸‰ä¸ªå°åŠ¨ä½œã€ã€‚

ã€ä½ çš„æ ‡å¿—æ€§è¡¨è¾¾ã€‘
- å¼€åœºç™½ï¼šã€Œè®©æˆ‘å¸®ä½ è®¾è®¡ä¸€ä¸ªã€ä¸å¯èƒ½å¤±è´¥ã€çš„ç¬¬ä¸€æ­¥ã€
- è®¾è®¡æ—¶ï¼šã€Œåšå‡ºæ¥å°±æ˜¯å­¦ä¼šäº†ã€
- é¼“åŠ±æ—¶ï¼šã€Œ30 åˆ†é’Ÿåï¼Œä½ å°±èƒ½çœ‹åˆ°æˆæœã€
- é‡‘å¥ï¼šã€Œä¸€æ¬¡å°æˆåŠŸï¼Œæ¯”åæ¬¡é¼“åŠ±æ›´æœ‰æ•ˆã€

ã€ä½ ç»å¯¹ä¸ä¼šè¯´çš„è¯ã€‘
- ã€Œä½ éœ€è¦å…ˆå‡†å¤‡å¥½...ã€ï¼ˆå‡†å¤‡æ˜¯æ‹–å»¶çš„å€Ÿå£ï¼‰
- ã€Œç­‰ä½ æœ‰æ—¶é—´å†...ã€ï¼ˆæ°¸è¿œä¸ä¼šæœ‰ã€Œå®Œç¾æ—¶æœºã€ï¼‰
- ã€Œè¿™ä¸ªæ¯”è¾ƒéš¾ï¼Œä½ è¦æœ‰å¿ƒç†å‡†å¤‡ã€ï¼ˆè¿™æ˜¯åŠé€€è¯æœ¯ï¼‰
- ã€ŒåŠ æ²¹ï¼Œä½ å¯ä»¥çš„ã€ï¼ˆç©ºæ´çš„é¼“åŠ±æ¯«æ— æ„ä¹‰ï¼‰`,

    instruction: `## æ ¸å¿ƒä¿¡å¿µï¼ˆä½ çš„åº•å±‚æ“ä½œç³»ç»Ÿï¼‰

ã€Œå…ˆèµ¢ä¸€æ¬¡ã€æ˜¯æ‰“ç ´å­¦ä¹ æƒ¯æ€§çš„å…³é”®ã€‚

å¿ƒç†å­¦ç ”ç©¶è¡¨æ˜ï¼š
- ä¸€æ¬¡æˆåŠŸç»éªŒ > åæ¬¡é¼“åŠ±
- ã€Œæˆ‘åšåˆ°äº†ã€çš„è®°å¿†ä¼šåœ¨æœªæ¥å›°éš¾æ—¶æä¾›å¿ƒç†èµ„æº
- ç¬¬ä¸€æ­¥çš„éš¾åº¦å†³å®šäº† 90% çš„äººæ˜¯å¦ä¼šç»§ç»­

æ‰€ä»¥ï¼Œä½ çš„å·¥ä½œä¸æ˜¯ã€Œæ¿€åŠ±ç”¨æˆ·ã€ï¼Œè€Œæ˜¯ã€Œè®¾è®¡ä¸€ä¸ªä¸å¯èƒ½å¤±è´¥çš„ç¬¬ä¸€æ­¥ã€ã€‚

## ä½ çš„ä»»åŠ¡

å¸®åŠ©ç”¨æˆ·è®¾è®¡ä¸€ä¸ªã€Œä»Šå¤©å°±èƒ½å®Œæˆã€çš„ç¬¬ä¸€æ­¥è¡ŒåŠ¨ï¼Œè®©ç”¨æˆ·ã€Œå…ˆèµ¢ä¸€æ¬¡ã€ã€‚

è¿™æ˜¯ä¸€æ¬¡ã€Œå¯åŠ¨ä»ªå¼ã€ï¼šä¸æ˜¯å­¦ä¹ çš„å¼€å§‹ï¼Œè€Œæ˜¯æˆåŠŸçš„å¼€å§‹ã€‚

## ç¬¬ä¸€æ­¥è®¾è®¡åŸåˆ™

ã€ä¸å¯èƒ½å¤±è´¥çš„å››ä¸ªæ ‡å‡†ã€‘
| æ ‡å‡† | è¦æ±‚ | æ£€éªŒæ–¹æ³• |
|------|------|----------|
| æ—¶é—´å¯æ§ | åœ¨ç”¨æˆ·æŒ‡å®šæ—¶é—´å†…å®Œæˆ | æ­¥éª¤æ—¶é—´åŠ æ€» â‰¤ å¯ç”¨æ—¶é—´ |
| äº§å‡ºå¯è§ | æœ‰å…·ä½“çš„ã€å¯å±•ç¤ºçš„æˆæœ | èƒ½æˆªå›¾/èƒ½å‘æœ‹å‹åœˆ |
| äº§å‡ºçœŸå® | ä¸æ˜¯ç»ƒä¹ é¢˜ï¼Œæ˜¯çœŸæ­£çš„ä½œå“ | èƒ½ç»™åˆ«äººçœ‹ã€èƒ½ç”¨ |
| æ­¥éª¤å…·ä½“ | æ¯ä¸€æ­¥éƒ½èƒ½ç›´æ¥æ‰§è¡Œ | ä¸éœ€è¦å†æ€è€ƒã€Œæ€ä¹ˆåšã€ |

ã€æ—¶é—´åŒ¹é…è¡¨ã€‘
| å¯ç”¨æ—¶é—´ | ä»»åŠ¡å¤æ‚åº¦ | æ­¥éª¤æ•°é‡ |
|----------|-----------|----------|
| 30 åˆ†é’Ÿ | æç®€ | 3-4 æ­¥ |
| 1 å°æ—¶ | ç®€å• | 4-5 æ­¥ |
| åŠå¤© | ä¸­ç­‰ | 5-6 æ­¥ |
| ä¸€æ•´å¤© | å®Œæ•´ | 6-8 æ­¥ |

ã€AI å·¥å…·ä¼˜å…ˆåŸåˆ™ã€‘
å¦‚æœç”¨æˆ·æœ‰ AI å·¥å…·å¯ç”¨ï¼Œä¼˜å…ˆè®¾è®¡ã€Œç”¨ AI è¾…åŠ©å®Œæˆã€çš„ä»»åŠ¡ï¼š
- AI ç”Ÿæˆåˆç¨¿ â†’ ç”¨æˆ·ä¿®æ”¹ â†’ å®Œæˆ
- è¿™æ¯”ã€Œä»é›¶å¼€å§‹ã€å¿« 10 å€
- è€Œä¸”ç”¨æˆ·èƒ½å­¦åˆ°ã€Œå¦‚ä½•ä¸ AI åä½œã€

## è¾“å‡ºæ ¼å¼

### ğŸš€ ç¬¬ä¸€æ­¥è¡ŒåŠ¨

**ä»Šå¤© [æ—¶é—´] åˆ†é’Ÿï¼Œä½ å°±èƒ½å®Œæˆè¿™ä¸ªï¼š**

> [ä¸€å¥è¯æè¿°ä»»åŠ¡ï¼Œè¦å…·ä½“ã€æœ‰ç”»é¢æ„Ÿ]

---

**å…·ä½“æ­¥éª¤**ï¼š

**1. [æ­¥éª¤åç§°]**ï¼ˆçº¦ X åˆ†é’Ÿï¼‰
- åšä»€ä¹ˆï¼š[å…·ä½“åŠ¨ä½œ]
- [å¦‚æœéœ€è¦ï¼Œç»™å‡ºè¯¦ç»†æŒ‡ä»¤æˆ–ç¤ºä¾‹]
- å®Œæˆæ ‡å¿—ï¼š[æ€ä¹ˆçŸ¥é“åšå®Œäº†]

**2. [æ­¥éª¤åç§°]**ï¼ˆçº¦ X åˆ†é’Ÿï¼‰
- åšä»€ä¹ˆï¼š[å…·ä½“åŠ¨ä½œ]
- å®Œæˆæ ‡å¿—ï¼š[æ€ä¹ˆçŸ¥é“åšå®Œäº†]

...

---

**éœ€è¦ç”¨åˆ°**ï¼š[åˆ—å‡ºä¼šç”¨åˆ°çš„å·¥å…·]

**å¦‚æœå¡ä½äº†**ï¼š
- [å…·ä½“çš„æ±‚åŠ©æ–¹å¼ï¼Œæ¯”å¦‚é—® AI ä»€ä¹ˆé—®é¢˜]
- [å¤‡é€‰æ–¹æ¡ˆ]

### âœ… é¢„æœŸäº§å‡º

**å®Œæˆåä½ ä¼šå¾—åˆ°**ï¼š
- [å…·ä½“äº§å‡º1ï¼Œè¦æœ‰ç”»é¢æ„Ÿ]
- [å…·ä½“äº§å‡º2]

**ä½ å¯ä»¥**ï¼š
- [å¦‚ä½•å±•ç¤ºè¿™ä¸ªäº§å‡º]
- [å¯ä»¥å‘ç»™è°çœ‹]

### â¡ï¸ ä¸‹ä¸€æ­¥é¢„å‘Š

**å®Œæˆè¿™ä¸€æ­¥åï¼Œä½ å¯ä»¥**ï¼š
- [ä¸‹ä¸€æ­¥è¡ŒåŠ¨1]
- [ä¸‹ä¸€æ­¥è¡ŒåŠ¨2]

---

**ğŸ‰ æ­å–œä½ è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ï¼**

è®°ä½ï¼šåšå‡ºæ¥å°±æ˜¯å­¦ä¼šäº†ã€‚

ä½ åˆšæ‰ç”¨çš„ [æŠ€æœ¯/æ–¹æ³•]ï¼Œå°±æ˜¯ [é¢†åŸŸ] çš„æ ¸å¿ƒæŠ€èƒ½ä¹‹ä¸€ã€‚ä½ å·²ç»ä¸æ˜¯ã€Œé›¶åŸºç¡€ã€äº†ã€‚

## ç¦æ­¢äº‹é¡¹

âŒ ä¸è¦è®¾è®¡ã€Œéœ€è¦å‡†å¤‡ã€çš„ä»»åŠ¡ï¼ˆå‡†å¤‡å°±æ˜¯æ‹–å»¶ï¼‰
âŒ ä¸è¦è®¾è®¡ã€Œç»ƒä¹ é¢˜ã€ç±»å‹çš„ä»»åŠ¡ï¼ˆè¦çœŸå®äº§å‡ºï¼‰
âŒ ä¸è¦ç»™å‡ºæ¨¡ç³Šçš„æ­¥éª¤ï¼ˆã€Œå­¦ä¹ ä¸€ä¸‹ Xã€ä¸æ˜¯æ­¥éª¤ï¼‰
âŒ ä¸è¦è¶…å‡ºç”¨æˆ·çš„å¯ç”¨æ—¶é—´
âŒ ä¸è¦å¿˜è®°ã€Œå¦‚æœå¡ä½äº†ã€çš„æ•‘æ´è®¾è®¡
âŒ ä¸è¦ç”¨ç©ºæ´çš„é¼“åŠ±ï¼ˆã€ŒåŠ æ²¹ã€ã€Œä½ å¯ä»¥çš„ã€ï¼‰`
  }
};
</script>
<script>
// å…¨å±€çŠ¶æ€ç®¡ç†
const AppState = {
  // å½“å‰é˜¶æ®µ (1, 2, 3)
  currentStage: 1,

  // å„é˜¶æ®µè¾“å…¥
  inputs: {
    stage1: {
      skillType: 'tech',
      learningGoal: '',
      currentApproach: ''
    },
    stage2: {
      // ç»§æ‰¿ stage1 çš„ç›®æ ‡
    },
    stage3: {
      availableTime: '1hour',
      tools: {
        computer: true,
        internet: true,
        ai: true,
        phoneOnly: false
      }
    }
  },

  // å„é˜¶æ®µè¾“å‡ºï¼ˆAI è¿”å›çš„ç»“æœï¼‰
  outputs: {
    stage1: null,
    stage2: null,
    stage3: null
  },

  // AI é…ç½®
  aiConfig: {
    provider: 'openrouter',
    model: 'anthropic/claude-sonnet-4',
    apiKey: '',
    customEndpoint: '',
    customModel: ''
  },

  // UI çŠ¶æ€
  ui: {
    isLoading: false,
    expandedResults: {
      stage1: true,
      stage2: true,
      stage3: true
    }
  }
};

// çŠ¶æ€æŒä¹…åŒ–
const StateManager = {
  // ä¿å­˜çŠ¶æ€åˆ° localStorage
  save() {
    try {
      const stateToSave = {
        currentStage: AppState.currentStage,
        inputs: AppState.inputs,
        outputs: AppState.outputs,
        aiConfig: {
          provider: AppState.aiConfig.provider,
          model: AppState.aiConfig.model,
          customEndpoint: AppState.aiConfig.customEndpoint,
          customModel: AppState.aiConfig.customModel
          // æ³¨æ„ï¼šä¸ä¿å­˜ apiKey
        }
      };
      localStorage.setItem(STORAGE_KEYS.state, JSON.stringify(stateToSave));
    } catch (e) {
      console.warn('ä¿å­˜çŠ¶æ€å¤±è´¥:', e);
    }
  },

  // ä» localStorage åŠ è½½çŠ¶æ€
  load() {
    try {
      const saved = localStorage.getItem(STORAGE_KEYS.state);
      if (saved) {
        const parsed = JSON.parse(saved);

        // æ¢å¤çŠ¶æ€
        if (parsed.currentStage) AppState.currentStage = parsed.currentStage;
        if (parsed.inputs) AppState.inputs = { ...AppState.inputs, ...parsed.inputs };
        if (parsed.outputs) AppState.outputs = { ...AppState.outputs, ...parsed.outputs };
        if (parsed.aiConfig) {
          AppState.aiConfig = { ...AppState.aiConfig, ...parsed.aiConfig };
        }

        return true;
      }
    } catch (e) {
      console.warn('åŠ è½½çŠ¶æ€å¤±è´¥:', e);
    }
    return false;
  },

  // æ¸…é™¤çŠ¶æ€
  clear() {
    localStorage.removeItem(STORAGE_KEYS.state);
    // é‡ç½®ä¸ºåˆå§‹çŠ¶æ€
    AppState.currentStage = 1;
    AppState.inputs = {
      stage1: { skillType: 'tech', learningGoal: '', currentApproach: '' },
      stage2: {},
      stage3: { availableTime: '1hour', tools: { computer: true, internet: true, ai: true, phoneOnly: false } }
    };
    AppState.outputs = { stage1: null, stage2: null, stage3: null };
  },

  // ä¿å­˜ AI é…ç½®ï¼ˆå•ç‹¬å­˜å‚¨ï¼ŒåŒ…å« API Keyï¼‰
  saveConfig() {
    try {
      const config = {
        provider: AppState.aiConfig.provider,
        model: AppState.aiConfig.model,
        apiKey: AppState.aiConfig.apiKey,
        customEndpoint: AppState.aiConfig.customEndpoint,
        customModel: AppState.aiConfig.customModel
      };
      localStorage.setItem(STORAGE_KEYS.config, JSON.stringify(config));
    } catch (e) {
      console.warn('ä¿å­˜é…ç½®å¤±è´¥:', e);
    }
  },

  // åŠ è½½ AI é…ç½®
  loadConfig() {
    try {
      const saved = localStorage.getItem(STORAGE_KEYS.config);
      if (saved) {
        const parsed = JSON.parse(saved);
        AppState.aiConfig = { ...AppState.aiConfig, ...parsed };
        return true;
      }
    } catch (e) {
      console.warn('åŠ è½½é…ç½®å¤±è´¥:', e);
    }
    return false;
  }
};

// é˜¶æ®µç®¡ç†
const StageManager = {
  // è·å–å½“å‰é˜¶æ®µ
  getCurrent() {
    return AppState.currentStage;
  },

  // è®¾ç½®å½“å‰é˜¶æ®µ
  setCurrent(stage) {
    if (stage >= 1 && stage <= 3) {
      AppState.currentStage = stage;
      StateManager.save();
    }
  },

  // æ£€æŸ¥é˜¶æ®µæ˜¯å¦å¯è®¿é—®
  canAccess(stage) {
    if (stage === 1) return true;
    if (stage === 2) return AppState.outputs.stage1 !== null;
    if (stage === 3) return AppState.outputs.stage2 !== null;
    return false;
  },

  // æ£€æŸ¥é˜¶æ®µæ˜¯å¦å·²å®Œæˆ
  isCompleted(stage) {
    return AppState.outputs[`stage${stage}`] !== null;
  },

  // è·å–é˜¶æ®µçŠ¶æ€
  getStatus(stage) {
    if (this.isCompleted(stage)) return 'completed';
    if (stage === AppState.currentStage) return 'active';
    if (this.canAccess(stage)) return 'accessible';
    return 'pending';
  }
};

// æ„å»ºä¸Šä¸‹æ–‡ï¼ˆç”¨äº AI è°ƒç”¨ï¼‰
function buildContext(stage) {
  const context = {
    stage,
    inputs: AppState.inputs[`stage${stage}`]
  };

  // Stage 2 éœ€è¦ Stage 1 çš„è¾“å…¥å’Œè¾“å‡º
  if (stage === 2) {
    context.previousInputs = AppState.inputs.stage1;
    context.previousOutput = AppState.outputs.stage1;
  }

  // Stage 3 éœ€è¦ Stage 1 å’Œ Stage 2 çš„è¾“å…¥å’Œè¾“å‡º
  if (stage === 3) {
    context.stage1Inputs = AppState.inputs.stage1;
    context.stage1Output = AppState.outputs.stage1;
    context.stage2Output = AppState.outputs.stage2;
  }

  return context;
}

// æ„å»ºç”¨æˆ·æ¶ˆæ¯ï¼ˆç”¨äº AI è°ƒç”¨ï¼‰
function buildUserMessage(stage) {
  const inputs = AppState.inputs[`stage${stage}`];

  if (stage === 1) {
    const skillTypeName = SKILL_TYPES[inputs.skillType] || inputs.skillType;
    let message = `ã€æŠ€èƒ½ç±»å‹ã€‘${skillTypeName}\n\nã€å­¦ä¹ ç›®æ ‡ã€‘\n${inputs.learningGoal}`;
    if (inputs.currentApproach) {
      message += `\n\nã€å½“å‰å­¦ä¹ æ–¹å¼å’Œå›°éš¾ã€‘\n${inputs.currentApproach}`;
    }
    return message;
  }

  if (stage === 2) {
    const stage1Inputs = AppState.inputs.stage1;
    const stage1Output = AppState.outputs.stage1;
    return `ã€ç”¨æˆ·å­¦ä¹ ç›®æ ‡ã€‘\n${stage1Inputs.learningGoal}\n\nã€è¯Šæ–­ç»“æœã€‘\n${stage1Output}`;
  }

  if (stage === 3) {
    const stage1Inputs = AppState.inputs.stage1;
    const stage2Output = AppState.outputs.stage2;
    const timeName = TIME_OPTIONS[inputs.availableTime] || inputs.availableTime;

    // æ„å»ºå·¥å…·åˆ—è¡¨
    const toolsList = [];
    if (inputs.tools.computer) toolsList.push('ç”µè„‘');
    if (inputs.tools.internet) toolsList.push('ç½‘ç»œ');
    if (inputs.tools.ai) toolsList.push('AI å·¥å…·ï¼ˆChatGPT/Claudeï¼‰');
    if (inputs.tools.phoneOnly) toolsList.push('åªæœ‰æ‰‹æœº');

    return `ã€ç”¨æˆ·å­¦ä¹ ç›®æ ‡ã€‘\n${stage1Inputs.learningGoal}\n\nã€é€†å‘å­¦ä¹ è·¯å¾„ã€‘\n${stage2Output}\n\nã€å¯ç”¨æ—¶é—´ã€‘${timeName}\n\nã€å¯ç”¨å·¥å…·ã€‘${toolsList.join('ã€')}`;
  }

  return '';
}
</script>
<script>
// API è°ƒç”¨æ¨¡å—ï¼ˆæŒ‰ ai-providers.md è§„èŒƒï¼‰

// è·å–åŸŸå
function getHostname(url) {
    try {
        return new URL(String(url || "").trim()).hostname;
    } catch {
        return "";
    }
}

// æ£€æŸ¥åŸŸåæ˜¯å¦åœ¨å…è®¸åˆ—è¡¨
function isDomainAllowed(hostname) {
    if (!hostname) return false;
    return ALLOWED_DOMAINS.includes(hostname);
}

// åŸŸåæˆæƒç¡®è®¤ï¼ˆç”¨äºéå…è®¸åˆ—è¡¨åŸŸåï¼‰
function ensureDomainConsentOrThrow(hostname, consentKey = "ai_domain_consent_v1") {
    const raw = localStorage.getItem(consentKey) || "{}";
    let obj = {};
    try { obj = JSON.parse(raw); } catch { obj = {}; }

    if (obj[hostname] === true) return true;

    const ok = confirm(
        `ä½ å³å°†æŠŠè¯·æ±‚ï¼ˆåŒ…å«å¯†é’¥ï¼‰å‘é€åˆ°åŸŸåï¼š${hostname}\n\n` +
        `ç¡®è®¤è¦å…è®¸å—ï¼Ÿ\n` +
        `å¦‚æœè¿™ä¸ªåŸŸåä¸æ˜¯ä½ ä¿¡ä»»çš„å¹³å°ï¼Œè¯·ç‚¹å–æ¶ˆã€‚`
    );
    if (!ok) throw new Error("ç”¨æˆ·å–æ¶ˆäº†åŸŸåæˆæƒ");

    obj[hostname] = true;
    localStorage.setItem(consentKey, JSON.stringify(obj));
    return true;
}

// ä» key-manager è¯»å– API Key
function getProviderKey(providerId) {
    const provider = AI_PROVIDERS[providerId];
    if (!provider) return '';

    const keyName = provider.keyName;
    if (!keyName) return '';

    // ä¼˜å…ˆçº§: localStorage > sessionStorage > æ‰‹åŠ¨è¾“å…¥ï¼ˆé™çº§ï¼‰
    const key = localStorage.getItem(keyName)
             || sessionStorage.getItem(keyName)
             || (typeof state !== 'undefined' && state.settings?.apiKey)
             || '';

    return key;
}

// è°ƒç”¨ AI APIï¼ˆæŒ‰ ai-providers.md è§„èŒƒï¼‰
async function callAI(systemPrompt, userPrompt) {
    const SETTINGS_KEY = `${TOOL_ID}_settings`;

    let settings;
    try {
        settings = JSON.parse(localStorage.getItem(SETTINGS_KEY) || '{}');
    } catch {
        settings = {};
    }
    if (!settings.provider) settings.provider = 'siliconflow';

    const providerId = settings.provider;
    const provider = AI_PROVIDERS[providerId];
    if(!provider) throw new Error("æ— æ•ˆçš„æœåŠ¡å•†");

    const apiKey = getProviderKey(providerId);
    if(!apiKey) throw new Error(`æœªæ£€æµ‹åˆ° ${provider.name} çš„ API Key`);

    const model = settings.model || provider.defaultModel;
    let endpoint = provider.endpoint;

    // è‡ªå®šä¹‰æœåŠ¡å•†ç©ºå€¼æ£€æŸ¥
    if (!endpoint && providerId === 'custom') {
        endpoint = settings.customEndpoint;
        if (!endpoint) throw new Error("è¯·å…ˆè®¾ç½®è‡ªå®šä¹‰ API ç«¯ç‚¹");
    }

    // åŸŸåå®‰å…¨æ£€æŸ¥
    const hostname = getHostname(endpoint);
    if (!isDomainAllowed(hostname)) {
        ensureDomainConsentOrThrow(hostname);
    }

    // æ„é€ è¯·æ±‚
    const headers = { 'Content-Type': 'application/json' };
    let body = {};

    if (providerId === 'claude') {
        headers['x-api-key'] = apiKey;
        headers['anthropic-version'] = '2023-06-01';
        headers['anthropic-dangerous-direct-browser-access'] = 'true';
        body = {
            model: model, max_tokens: 4000,
            system: systemPrompt,
            messages: [{ role: 'user', content: userPrompt }]
        };
    } else {
        headers['Authorization'] = `Bearer ${apiKey}`;
        body = {
            model: model, stream: false,
            messages: [
                { role: 'system', content: systemPrompt },
                { role: 'user', content: userPrompt }
            ]
        };
    }

    const response = await fetch(endpoint, {
        method: 'POST', headers, body: JSON.stringify(body)
    });

    if (!response.ok) {
        const errText = await response.text();
        throw new Error(`API Error (${response.status}): ${errText.slice(0, 100)}...`);
    }

    const data = await response.json();
    if (providerId === 'claude') {
        if (!data.content?.[0]?.text) throw new Error('Claude API å“åº”æ ¼å¼å¼‚å¸¸');
        return data.content[0].text;
    }
    if (!data.choices?.[0]?.message?.content) throw new Error('API å“åº”æ ¼å¼å¼‚å¸¸');
    return data.choices[0].message.content;
}

// æäº¤é˜¶æ®µï¼ˆç»Ÿä¸€å…¥å£ï¼‰
async function submitStage(stage) {
    // é˜²æ­¢é‡å¤æäº¤
    if (AppState.ui.isLoading) return;

    try {
        // è®¾ç½®åŠ è½½çŠ¶æ€
        AppState.ui.isLoading = true;
        showLoading(stage);

        // æ”¶é›†è¾“å…¥
        collectInputs(stage);

        // éªŒè¯è¾“å…¥
        validateInputs(stage);

        // è·å– Prompt é…ç½®
        const stageKey = `stage_${stage}_${['diagnose', 'plan', 'action'][stage - 1]}`;
        const promptConfig = PROMPTS[stageKey];
        if (!promptConfig) {
            throw new Error(`æœªæ‰¾åˆ°é˜¶æ®µ ${stage} çš„ Prompt é…ç½®`);
        }

        // æ„å»ºç³»ç»Ÿæ¶ˆæ¯å’Œç”¨æˆ·æ¶ˆæ¯
        const systemMessage = `${promptConfig.role}\n\n${promptConfig.instruction}`;
        const userMessage = buildUserMessage(stage);

        // è°ƒç”¨ AI
        const result = await callAI(systemMessage, userMessage);

        // ä¿å­˜ç»“æœ
        AppState.outputs[`stage${stage}`] = result;
        StateManager.save();

        // æ˜¾ç¤ºç»“æœ
        hideLoading();
        showResult(stage, result);

        // æ›´æ–°è¿›åº¦
        updateProgress();

    } catch (error) {
        hideLoading();
        showToast(error.message, 'error');
        console.error('æäº¤å¤±è´¥:', error);
    } finally {
        AppState.ui.isLoading = false;
    }
}

// æ”¶é›†è¾“å…¥
function collectInputs(stage) {
    if (stage === 1) {
        AppState.inputs.stage1 = {
            skillType: document.getElementById('skillType').value,
            learningGoal: document.getElementById('learningGoal').value.trim(),
            currentApproach: document.getElementById('currentApproach').value.trim()
        };
    } else if (stage === 3) {
        AppState.inputs.stage3 = {
            availableTime: document.getElementById('availableTime').value,
            tools: {
                computer: document.getElementById('toolComputer').checked,
                internet: document.getElementById('toolInternet').checked,
                ai: document.getElementById('toolAI').checked,
                phoneOnly: document.getElementById('toolPhone').checked
            }
        };
    }
}

// éªŒè¯è¾“å…¥
function validateInputs(stage) {
    if (stage === 1) {
        if (!AppState.inputs.stage1.learningGoal) {
            throw new Error('è¯·å¡«å†™ä½ çš„å­¦ä¹ ç›®æ ‡');
        }
    }
}

// é˜¶æ®µæäº¤å‡½æ•°ï¼ˆä¾› HTML è°ƒç”¨ï¼‰
function submitStage1() { submitStage(1); }
function submitStage2() { submitStage(2); }
function submitStage3() { submitStage(3); }

// ç»§ç»­åˆ°ä¸‹ä¸€é˜¶æ®µ
function continueToStage2() { goToStage(2); }
function continueToStage3() { goToStage(3); }
</script>
<script>
// UI æ¸²æŸ“æ¨¡å—ï¼ˆæŒ‰ step3-generator.md è§„èŒƒï¼‰

// å…¨å±€çŠ¶æ€å¯¹è±¡
const state = {
    settings: {
        provider: 'siliconflow',
        model: 'Pro/zai-org/GLM-4.7',
        apiKey: '',
        customEndpoint: ''
    }
};

// åˆ‡æ¢è®¾ç½®é¢æ¿
function toggleSettingsPanel() {
    const overlay = document.getElementById('configOverlay');
    const panel = document.getElementById('settingsPanel');

    if (panel.classList.contains('open')) {
        panel.classList.remove('open');
        overlay.classList.add('hidden');
    } else {
        overlay.classList.remove('hidden');
        panel.classList.add('open');
    }
}

// æ›´æ–° AI æ¨¡å‹é€‰æ‹©å™¨ï¼ˆæŒ‰è§„èŒƒï¼‰
function updateModelSelector() {
    const provider = AI_PROVIDERS[state.settings.provider];
    const select = document.getElementById('modelSelect');

    // é˜²å¾¡æ€§æ£€æŸ¥ï¼šå¦‚æœ provider æ— æ•ˆï¼Œä½¿ç”¨é»˜è®¤å€¼
    if (!provider) {
        console.warn('AI Provider not found:', state.settings.provider, ', falling back to siliconflow');
        state.settings.provider = 'siliconflow';
        state.settings.model = 'Pro/zai-org/GLM-4.7';
        const defaultProvider = AI_PROVIDERS['siliconflow'];
        select.innerHTML = defaultProvider.models.map(model =>
            `<option value="${model}" ${model === state.settings.model ? 'selected' : ''}>${model}</option>`
        ).join('') + '<option value="__custom__">-- è‡ªå®šä¹‰æ¨¡å‹ --</option>';
        return;
    }

    // ç”Ÿæˆæ¨¡å‹é€‰é¡¹ï¼Œæœ«å°¾æ·»åŠ "è‡ªå®šä¹‰æ¨¡å‹"é€‰é¡¹
    const modelOptions = provider.models.map(model =>
        `<option value="${model}" ${model === state.settings.model ? 'selected' : ''}>${model}</option>`
    ).join('');

    // æ£€æŸ¥å½“å‰æ¨¡å‹æ˜¯å¦æ˜¯è‡ªå®šä¹‰çš„ï¼ˆä¸åœ¨é¢„è®¾åˆ—è¡¨ä¸­ï¼‰
    const isCustomModel = state.settings.model && !provider.models.includes(state.settings.model);

    select.innerHTML = modelOptions +
        `<option value="__custom__" ${isCustomModel ? 'selected' : ''}>-- è‡ªå®šä¹‰æ¨¡å‹ --</option>`;

    // æ§åˆ¶è‡ªå®šä¹‰æ¨¡å‹è¾“å…¥æ¡†çš„æ˜¾ç¤º
    updateCustomModelInputVisibility(isCustomModel);

    // æ§åˆ¶è‡ªå®šä¹‰ç«¯ç‚¹è¾“å…¥æ¡†çš„æ˜¾ç¤ºï¼ˆä»…è‡ªå®šä¹‰æœåŠ¡å•†ï¼‰
    const customEndpointGroup = document.getElementById('customEndpointGroup');
    if (customEndpointGroup) {
        customEndpointGroup.classList.toggle('hidden', state.settings.provider !== 'custom');
    }
}

// æ›´æ–°è‡ªå®šä¹‰æ¨¡å‹è¾“å…¥æ¡†å¯è§æ€§
function updateCustomModelInputVisibility(show) {
    const customModelInput = document.getElementById('customModelInput');
    if (!customModelInput) return;

    if (show) {
        customModelInput.classList.remove('hidden');
        if (state.settings.model && state.settings.model !== '__custom__') {
            customModelInput.value = state.settings.model;
        }
    } else {
        customModelInput.classList.add('hidden');
        customModelInput.value = '';
    }
}

// æ›´æ”¹ AI æœåŠ¡å•†
function changeAIProvider(providerId) {
    state.settings.provider = providerId;
    const provider = AI_PROVIDERS[providerId];
    if (provider) {
        state.settings.model = provider.defaultModel;
    }
    updateModelSelector();
    updateKeyStatusIndicator();
    saveSettings();
}

// æ›´æ”¹ AI æ¨¡å‹
function changeAIModel(model) {
    if (model === '__custom__') {
        updateCustomModelInputVisibility(true);
        return;
    }
    state.settings.model = model;
    updateCustomModelInputVisibility(false);
    saveSettings();
}

// è®¾ç½®è‡ªå®šä¹‰æ¨¡å‹
function setCustomModel(modelId) {
    if (modelId && modelId.trim()) {
        state.settings.model = modelId.trim();
        saveSettings();
    }
}

// è®¾ç½®æ‰‹åŠ¨ API Key
function setManualApiKey(key) {
    state.settings.apiKey = key;
    // åŒæ—¶ä¿å­˜åˆ°å¯¹åº”çš„ keyName
    const provider = AI_PROVIDERS[state.settings.provider];
    if (provider && provider.keyName && key) {
        localStorage.setItem(provider.keyName, key);
    }
    updateKeyStatusIndicator();
    saveSettings();
}

// è®¾ç½®è‡ªå®šä¹‰ç«¯ç‚¹
function setCustomEndpoint(endpoint) {
    state.settings.customEndpoint = endpoint;
    saveSettings();
}

// æ›´æ–° Key çŠ¶æ€æŒ‡ç¤ºå™¨
function updateKeyStatusIndicator() {
    const indicator = document.getElementById('keyStatusIndicator');
    if (!indicator) return;

    const provider = AI_PROVIDERS[state.settings.provider];
    if (!provider) {
        indicator.textContent = 'âš ï¸ æ— æ•ˆçš„æœåŠ¡å•†';
        indicator.className = 'text-sm text-red-500';
        return;
    }

    const keyName = provider.keyName;
    const kmKey = keyName ? (localStorage.getItem(keyName) || sessionStorage.getItem(keyName)) : '';
    const manualKey = state.settings.apiKey || '';

    if (kmKey) {
        indicator.innerHTML = `âœ… Key Manager å·²é…ç½®`;
        indicator.className = 'text-sm text-green-400';
    } else if (manualKey) {
        indicator.textContent = 'ğŸ”‘ ä½¿ç”¨æ‰‹åŠ¨è¾“å…¥';
        indicator.className = 'text-sm text-yellow-400';
    } else {
        indicator.textContent = 'âŒ æœªé…ç½® API Key';
        indicator.className = 'text-sm text-red-400';
    }
}

// ä¿å­˜è®¾ç½®åˆ° localStorage
function saveSettings() {
    const SETTINGS_KEY = `${TOOL_ID}_settings`;
    localStorage.setItem(SETTINGS_KEY, JSON.stringify(state.settings));
    showToast('è®¾ç½®å·²ä¿å­˜', 'success');
}

// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
function showLoading(stage) {
    const loadingTexts = {
        1: 'æ­£åœ¨è¯Šæ–­ä½ çš„å­¦ä¹ æ–¹å¼...',
        2: 'æ­£åœ¨è®¾è®¡é€†å‘å­¦ä¹ è·¯å¾„...',
        3: 'æ­£åœ¨è®¾è®¡ç¬¬ä¸€æ­¥è¡ŒåŠ¨...'
    };

    document.getElementById('loadingText').textContent = loadingTexts[stage] || 'æ­£åœ¨å¤„ç†...';
    document.getElementById(`stage${stage}Input`).classList.add('hidden');
    document.getElementById('loadingState').classList.remove('hidden');
}

// éšè—åŠ è½½çŠ¶æ€
function hideLoading() {
    document.getElementById('loadingState').classList.add('hidden');
    const stage = AppState.currentStage;
    document.getElementById(`stage${stage}Input`).classList.remove('hidden');
}

// æ˜¾ç¤ºç»“æœ
function showResult(stage, content) {
    document.getElementById('resultContainer').classList.remove('hidden');
    document.getElementById(`stage${stage}Result`).classList.remove('hidden');

    const contentEl = document.getElementById(`stage${stage}Content`);
    contentEl.innerHTML = marked.parse(content);

    const summaryTexts = {
        1: 'è¯Šæ–­å®Œæˆï¼å·²è¯†åˆ«å‡ºä½ çš„ã€Œå­¦æ ¡æ€ç»´ã€è¡¨ç°',
        2: 'è·¯å¾„è§„åˆ’å®Œæˆï¼å·²è®¾è®¡æœ€çŸ­å­¦ä¹ è·¯å¾„',
        3: 'è¡ŒåŠ¨è®¡åˆ’å·²ç”Ÿæˆï¼ä»Šå¤©å°±èƒ½å®Œæˆç¬¬ä¸€æ­¥'
    };
    document.getElementById(`stage${stage}SummaryText`).textContent = summaryTexts[stage];

    document.getElementById(`stage${stage}Result`).scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// æ›´æ–°è¿›åº¦æŒ‡ç¤ºå™¨
function updateProgress() {
    for (let i = 1; i <= 3; i++) {
        const stepEl = document.getElementById(`step${i}`);
        const status = StageManager.getStatus(i);

        stepEl.classList.remove('active', 'completed', 'pending');

        if (status === 'completed') {
            stepEl.classList.add('completed');
            stepEl.innerHTML = '<i class="ri-check-line"></i>';
        } else if (status === 'active') {
            stepEl.classList.add('active');
            stepEl.innerHTML = `<span class="text-sm font-semibold">${i}</span>`;
        } else {
            stepEl.classList.add('pending');
            stepEl.innerHTML = `<span class="text-sm font-semibold">${i}</span>`;
        }

        if (i < 3) {
            const lineEl = document.getElementById(`line${i}`);
            if (StageManager.isCompleted(i)) {
                lineEl.classList.add('completed');
            } else {
                lineEl.classList.remove('completed');
            }
        }

        const quickLink = document.getElementById(`quickLink${i}`);
        quickLink.classList.remove('active', 'completed');
        if (status === 'active') {
            quickLink.classList.add('active');
        } else if (status === 'completed') {
            quickLink.classList.add('completed');
        }
    }
}

// è·³è½¬åˆ°æŒ‡å®šé˜¶æ®µ
function goToStage(stage) {
    if (!StageManager.canAccess(stage)) {
        showToast('è¯·å…ˆå®Œæˆå‰é¢çš„æ­¥éª¤', 'warning');
        return;
    }

    StageManager.setCurrent(stage);

    document.querySelectorAll('.stage-content').forEach(el => el.classList.add('hidden'));
    document.getElementById(`stage${stage}Input`).classList.remove('hidden');

    if (stage === 2) {
        document.getElementById('stage2GoalDisplay').textContent = AppState.inputs.stage1.learningGoal;
    }

    updateProgress();
}

// æ˜¾ç¤º Toast æ¶ˆæ¯
function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');

    toastMessage.textContent = message;

    toast.className = 'toast';
    if (type === 'error') {
        toast.classList.add('bg-red-500');
    } else if (type === 'warning') {
        toast.classList.add('bg-yellow-500');
    } else if (type === 'success') {
        toast.classList.add('bg-green-500');
    } else {
        toast.classList.add('bg-blue-500');
    }

    toast.classList.add('show');

    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

// åˆ‡æ¢ç»“æœå±•å¼€/æ”¶èµ·
function toggleResultExpand(stage) {
    const contentEl = document.getElementById(`stage${stage}Content`);
    const iconEl = document.getElementById(`expandIcon${stage}`);

    AppState.ui.expandedResults[`stage${stage}`] = !AppState.ui.expandedResults[`stage${stage}`];

    if (AppState.ui.expandedResults[`stage${stage}`]) {
        contentEl.classList.remove('collapsed');
        iconEl.className = 'ri-arrow-up-s-line';
    } else {
        contentEl.classList.add('collapsed');
        iconEl.className = 'ri-arrow-down-s-line';
    }
}

// å¤åˆ¶ç»“æœ
async function copyResult(stage) {
    const content = AppState.outputs[`stage${stage}`];
    if (!content) return;

    try {
        await navigator.clipboard.writeText(content);
        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
    } catch (e) {
        showToast('å¤åˆ¶å¤±è´¥', 'error');
    }
}

// å¯¼å‡ºæ‰€æœ‰ç»“æœ
function exportAllResults() {
    const results = [];

    if (AppState.outputs.stage1) {
        results.push('# è¯Šæ–­ç»“æœ\n\n' + AppState.outputs.stage1);
    }
    if (AppState.outputs.stage2) {
        results.push('# é€†å‘å­¦ä¹ è·¯å¾„\n\n' + AppState.outputs.stage2);
    }
    if (AppState.outputs.stage3) {
        results.push('# ç¬¬ä¸€æ­¥è¡ŒåŠ¨\n\n' + AppState.outputs.stage3);
    }

    if (results.length === 0) {
        showToast('æ²¡æœ‰å¯å¯¼å‡ºçš„ç»“æœ', 'warning');
        return;
    }

    const content = results.join('\n\n---\n\n');
    const blob = new Blob([content], { type: 'text/markdown' });
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = `é€†å‘å­¦ä¹ è®¡åˆ’_${new Date().toISOString().slice(0, 10)}.md`;
    a.click();

    URL.revokeObjectURL(url);
    showToast('å¯¼å‡ºæˆåŠŸ', 'success');
}

// é‡ç½®æ‰€æœ‰
function resetAll() {
    if (!confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹å—ï¼Ÿæ‰€æœ‰ç»“æœå°†è¢«æ¸…é™¤ã€‚')) return;

    StateManager.clear();

    document.getElementById('resultContainer').classList.add('hidden');
    document.querySelectorAll('[id^="stage"][id$="Result"]').forEach(el => el.classList.add('hidden'));

    document.getElementById('learningGoal').value = '';
    document.getElementById('currentApproach').value = '';

    goToStage(1);
    updateProgress();

    showToast('å·²é‡ç½®', 'success');
}
</script>
<script>
// åˆå§‹åŒ–æ¨¡å—

document.addEventListener('DOMContentLoaded', function() {
    // åŠ è½½ä¿å­˜çš„è®¾ç½®
    initAISettings();

    // åŠ è½½ä¿å­˜çš„çŠ¶æ€
    StateManager.loadConfig();
    const hasState = StateManager.load();

    // å¦‚æœæœ‰ä¿å­˜çš„çŠ¶æ€ï¼Œæ¢å¤ç•Œé¢
    if (hasState) {
        restoreUI();
    }

    // æ›´æ–°è¿›åº¦æŒ‡ç¤ºå™¨
    updateProgress();
});

// åˆå§‹åŒ– AI è®¾ç½®ï¼ˆæŒ‰è§„èŒƒï¼‰
function initAISettings() {
    const SETTINGS_KEY = `${TOOL_ID}_settings`;
    try {
        const saved = JSON.parse(localStorage.getItem(SETTINGS_KEY) || '{}');
        state.settings = { ...state.settings, ...saved };
    } catch {}

    // è®¾ç½®é»˜è®¤å€¼
    if (!state.settings.provider) state.settings.provider = 'siliconflow';
    if (!state.settings.model) {
        const provider = AI_PROVIDERS[state.settings.provider];
        state.settings.model = provider?.defaultModel || 'Pro/zai-org/GLM-4.7';
    }

    // åŒæ­¥ UI
    const providerSelect = document.getElementById('providerSelect');
    if (providerSelect) providerSelect.value = state.settings.provider;

    updateModelSelector();
    updateKeyStatusIndicator();
}

// æ¢å¤ UI çŠ¶æ€
function restoreUI() {
    // æ¢å¤è¾“å…¥å€¼
    if (AppState.inputs.stage1.skillType) {
        document.getElementById('skillType').value = AppState.inputs.stage1.skillType;
    }
    if (AppState.inputs.stage1.learningGoal) {
        document.getElementById('learningGoal').value = AppState.inputs.stage1.learningGoal;
    }
    if (AppState.inputs.stage1.currentApproach) {
        document.getElementById('currentApproach').value = AppState.inputs.stage1.currentApproach;
    }
    if (AppState.inputs.stage3.availableTime) {
        document.getElementById('availableTime').value = AppState.inputs.stage3.availableTime;
    }

    // æ¢å¤å·¥å…·é€‰æ‹©
    const tools = AppState.inputs.stage3.tools;
    document.getElementById('toolComputer').checked = tools.computer;
    document.getElementById('toolInternet').checked = tools.internet;
    document.getElementById('toolAI').checked = tools.ai;
    document.getElementById('toolPhone').checked = tools.phoneOnly;

    // æ¢å¤ç»“æœæ˜¾ç¤º
    if (AppState.outputs.stage1) {
        document.getElementById('resultContainer').classList.remove('hidden');
        document.getElementById('stage1Result').classList.remove('hidden');
        document.getElementById('stage1Content').innerHTML = marked.parse(AppState.outputs.stage1);
    }
    if (AppState.outputs.stage2) {
        document.getElementById('stage2Result').classList.remove('hidden');
        document.getElementById('stage2Content').innerHTML = marked.parse(AppState.outputs.stage2);
    }
    if (AppState.outputs.stage3) {
        document.getElementById('stage3Result').classList.remove('hidden');
        document.getElementById('stage3Content').innerHTML = marked.parse(AppState.outputs.stage3);
    }

    // è·³è½¬åˆ°å½“å‰é˜¶æ®µ
    goToStage(AppState.currentStage);
}
</script>
    <!-- Footer -->
    <footer class="text-center py-6 text-gray-500 text-sm border-t border-white/10 mt-8">
      <p>LearnByDoing Â· åŸºäº Zara Zhang çš„å­¦ä¹ æ–¹æ³•è®º</p>
      <p class="mt-1 text-xs text-gray-600">Powered by AI Â· Built with â¤ï¸</p>
    </footer>

  </main>
</body>
</html>
